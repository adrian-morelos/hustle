!function(e){"use strict";window.Hustle=function(e,t,i){var s={},n={evaluate:/<#([\s\S]+?)#>/g,interpolate:/\{\{\{([\s\S]+?)\}\}\}/g,escape:/\{\{([^\}]+?)\}\}(?!\})/g},o=function(n,o){var a=n.split(".");if(a.length){var l=function(s,n){var a=s.split("."),r=a.splice(0,1)[0];if(r){if(a.length)n[r]=n[r]||{};else{var c=o.call(null,e,t,i);n[r]=_.isFunction(c)||"undefined"==typeof c?c:_.extend(n[r]||{},c)}a.length&&r&&l(a.join("."),n[r])}};l(n,s)}else{var r=s[n]||{};s[n]=_.extend(r,o.call(null,e,t,i))}},a=function(){return s},l=function(e){if(e.split(".").length){var t=!1,i=function(e,s){var n=e.split("."),o=n.splice(0,1)[0];t=s[o],n.length&&i(n.join("."),s[o])};return i(e,s),t}return s[e]||!1},r=_.extend({},Backbone.Events),c=Backbone.View.extend({__base_events:{"click .wph-tabs--wrap .wph-tabs--nav li label":"__base_toggle_tab"},initialize:function(){this.events=_.extend({},this.events,this.__base_events),_.isFunction(this.init_mix)&&this.init_mix.apply(this,arguments),this.render&&(this.render=_.wrap(this.render,function(e){this.trigger("before_render"),e.call(this),r.trigger("view.rendered",this),this.trigger("rendered")})),_.isFunction(this.init)&&this.init.apply(this,arguments)},__base_toggle_tab:function(e){var t=this.$(e.target),i=(t.attr("href")||"").replace(/^\#/,""),s=!!i&&this.$("#"+i),n=t.closest(".wph-tabs--wrap"),o=t.closest("li");s&&s.length&&(n.find(".wph-tabs--content").not(s).removeClass("current"),s.addClass("current"),o.addClass("current"),o.siblings().removeClass("current"))}}),d=_.memoize(function(e){var t;return function(i){return t=t||_.template(document.getElementById(e).innerHTML,null,n),t(i).replace("/*<![CDATA[*/","").replace("/*]]>*/","")}}),p=_.memoize(function(e){var t;return function(i){return(t=t||_.template(e,null,n))(i)}}),h=function(){return e.extend(!0,{},n)},u=function(){var t=function(e){var t,i,s,n=document.cookie.split(";");for(s=e+"=",t=0;t<n.length;t+=1){for(i=n[t];" "===i.charAt(0);)i=i.substring(1,i.length);if(0===i.indexOf(s)){var o=i.substring(s.length,i.length);return o?JSON.parse(o):o}}return null},i=function(t,i,s){var n,o;i=e.isArray(i)||e.isPlainObject(i)?JSON.stringify(i):i,isNaN(s)?o="":(n=new Date,n.setTime(n.getTime()+24*s*60*60*1e3),o="; expires="+n.toGMTString()),document.cookie=t+"="+i+o+"; path=/"};return{set:i,get:t}}(),g=function(){return{Never_See_Aagain_Prefix:"hustle_never_see_again-",Module_Show_Count:"hustle_module_show_count-",Slide_Cookie_Prefix:"hustle_slide_in_prefix-",Slide_Cookie_Hide_All:"hustle_slide_in_hide_all-",SS_Module_Show_Count:"hustle_ss_module_show_count-"}}();return{define:o,get_modules:a,get:l,Events:r,View:c,template:d,create_template:p,get_template_options:h,cookie:u,consts:g}}(jQuery,document,window)}(jQuery);var Optin=Optin||{};Optin.View={},Optin.Models={},Optin.Events={},"undefined"!=typeof Backbone&&_.extend(Optin.Events,Backbone.Events),function(e){"use strict";Optin.COOKIE_PREFIX="inc_optin_long_hidden-",Optin.POPUP_COOKIE_PREFIX="inc_optin_popup_long_hidden-",Optin.SLIDE_IN_COOKIE_PREFIX="inc_optin_slide_in_long_hidden-",Optin.SLIDE_IN_COOKIE_HIDE_ALL="inc_optin_slide_in_hide_all",Optin.global_mixin=function(){_.mixin({log:function(){console.log(arguments)},toBool:function(e){return _.isBoolean(e)?e:_.isString(e)&&["true","false","1"].indexOf(e.toLowerCase())!==-1?"true"===e.toLowerCase()||"1"===e.toLowerCase():_.isNumber(e)?!!e:!(_.isUndefined(e)||_.isNull(e)||_.isNaN(e))&&e},isTrue:function(e){return!(_.isUndefined(e)||_.isNull(e)||_.isNaN(e))&&(_.isNumber(e)?0!==e:(e=e.toString().toLowerCase(),["1","true","on"].indexOf(e)!==-1))},isFalse:function(e){return!_.isTrue(e)},control_base:function(e,t,i){return i=_.isUndefined(i)?"checked":i,e=_.toBool(e),t=_.isBoolean(e)?_.isTrue(t):t,_.isEqual(e,t)?i+"="+i:""},checked:function(e,t){return _.control_base(e,t,"checked")},selected:function(e,t){return _.control_base(e,t,"selected")},disabled:function(e,t){return _.control_base(e,t,"disabled")},"class":function(e,t,i){return _.isTrue(e)?t:"undefined"!=typeof i?i:""},add_class:function(e,t,i){return"class={class}".replace("{class}",_["class"](e,t,i))},toUpperCase:function(e){return _.isString(e)?e.toUpperCase():""}}),_.findKey||_.mixin({findKey:function(e,t,i){t=cb(t,i);for(var s,n=_.keys(e),o=0,a=n.length;o<a;o++)if(s=n[o],t(e[s],s,e))return s}})},Optin.global_mixin(),Backbone.Model.prototype.toJSON=function(){var e=_.clone(this.attributes);for(var t in e)(e[t]instanceof Backbone.Model||Backbone.Collection&&e[t]instanceof Backbone.Collection)&&(e[t]=e[t].toJSON());return e},String.prototype.toInt=function(){return parseInt(this,10)},String.prototype.isEmpty=function(){return 0===this.length||!this.trim()},Optin.template=_.memoize(function(t){var i,s={evaluate:/<#([\s\S]+?)#>/g,interpolate:/\{\{\{([\s\S]+?)\}\}\}/g,escape:/\{\{([^\}]+?)\}\}(?!\})/g};return function(n){return i=i||_.template(e("#"+t).html(),null,s),i(n).replace("/*<![CDATA[*/","").replace("/*]]>*/","")}}),Optin.template_compat=_.memoize(function(t){var i;return function(s){return i=i||_.template(e("#"+t).html()),i(s).replace("/*<![CDATA[*/","").replace("/*]]>*/","")}}),Optin.cookie=Hustle.cookie,e(document).on("blur","input, textarea, select",function(){var t=e(this);t.is(":input[type=button], :input[type=submit], :input[type=reset]")||(t.val()&&t.val().trim&&""!==t.val().trim()?t.parent().addClass("wpoi-filled"):t.parent().removeClass("wpoi-filled"))}),Optin.Mixins={_mixins:{},_services_mixins:{},_desing_mixins:{},_display_mixins:{},add:function(e,t){this._mixins[e]=t},get_mixins:function(){return this._mixins},add_services_mixin:function(e,t){this._services_mixins[e]=t},get_services_mixins:function(){return this._services_mixins}}}(jQuery),function(e){"use strict";Hustle.Optin=Optin,Optin.View.Template_Mixin={events:{"change input[type=text]":"set_model_texts","keyup .wpoi_contenteditable":"set_model_contenteditables","change input[type=radio]":"set_model_radios","change select":"set_model_selects","change input[type=checkbox]":"set_model_checkboxes","blur input[type=text]":"set_model_selects","blur input[type=number]":"set_model_selects"},set_model_texts:function(t){var i=e(t.target),s=i.data("attribute");console.log(s,t.target.value),this.model.set(s,t.target.value)},set_model_contenteditables:function(t){var i=e(t.target),s=i.data("attribute");this.model.set(s,i.text())},set_model_radios:function(t){var i=e(t.target),s=i.data("attribute");this.model.set(s,t.target.value)},set_model_selects:function(t){var i=e(t.target),s=i.data("attribute");this.model.set(s,t.target.value)},set_model_checkboxes:function(t){var i=e(t.target),s=i.data("attribute");this.model.set(s,i.is(":checked"))}}}(jQuery),Hustle.define("Modal",function(e){"use strict";return Backbone.View.extend({template:Optin.template("hustle-modal-tpl"),$mask:e('<div class="wph-modal--mask"></div>'),opts:{},data:{id:"",type:"popup",style:"",title:"",subtitle:"",content:"Content",animation_in:"",animation_out:"",position:""},events:{"click .wph-modal--close a":"hide","submit form":"fire_conversion_event","click .wph-modal--cta":"fire_conversion_event","click .wph-modal-never-see-again":"never_see_again"},initialize:function(e){return this.opts=_.extend({},this.opts,e),e.template&&(this.template=e.template),this.render(),this},render:function(){var e=_.extend({},this.data,this.model.toJSON());if(this.type_data=e.types[e.type],this.animation_in=e.animation_in=e.types[e.type].animation_in||e.animation_in,this.animation_out=e.animation_out=e.types[e.type].animation_out||e.animation_out,e.position=e.types[e.type].position||e.position,e=this.sanitize_cta_url(e),e=this.enable_fullscreen(e),e=this.handle_custom_size_cc(e),this.setElement(this.template(e)),this.$mask=this.$mask.clone(),this.$mask.on("click",_.bind(this.clicked_background,this)),this.$el.find("form").on("submit",_.bind(this.on_form_submit,this)),this.enable_body_scroll(e),window.hasOwnProperty("optin_vars")){var t=this.$el.find("a.wph-icon.i-close");t.length&&t.parent().hide()}return this},hide:function(t){var i=this;t&&t.preventDefault(),i.animation_in!==i.animation_out&&i.$el.removeClass(i.animation_in),_.delay(function(){i.animation_out&&!i.$el.hasClass(i.animation_out)&&i.$el.addClass(i.animation_out),_.delay(function(){i.$el.removeClass("wph-modal-show"),i.$el.prev(".wph-modal--mask").remove(),Hustle.Events.trigger("hide_modal",i),i.trigger("hidden"),_.isTrue(i.type_data.close_btn_as_never_see)&&t&&e(t.target).hasClass("wph-icon i-close")&&i.never_see_again(t)},550)},350),e("html").removeClass("no-scroll")},clicked_background:function(e){_.isTrue(this.type_data.not_close_on_background_click)||this.hide(e)},show:function(){var e=this;if(!window.hasOwnProperty("optin_vars")){var t=Hustle.consts.Module_Show_Count+this.model.get("type")+"-"+this.model.get("id"),i=Hustle.cookie.get(t);Hustle.cookie.set(t,i+1,90)}e.animation_in!==e.animation_out&&e.$el.removeClass(e.animation_out),_.delay(function(){e.$el.addClass("wph-modal-show"),e.trigger("shown",e,e.model.get("type")),Hustle.Events.trigger("show_modal",e,e.model.get("type")),_.delay(function(){e.animation_in&&!e.$el.hasClass(e.animation_in)&&e.$el.addClass(e.animation_in)},350)},550)},sanitize_cta_url:function(e){return e.cta_url&&(/^(f|ht)tps?:\/\//i.test(e.cta_url)||(e.cta_url="http://"+e.cta_url)),e},enable_fullscreen:function(e){if(e.fullscreen="",!e||"undefined"==typeof e.optin_provider||"undefined"==typeof e.type)return e;if("custom_content"==e.optin_provider&&"popup"==e.type){if("undefined"==typeof this.type_data.make_fullscreen)return e;_.isTrue(this.type_data.make_fullscreen)&&(e.fullscreen="wph-modal-popup-fullscreen")}return e},handle_custom_size_cc:function(e){return e.custom_size_attr="",e.custom_size_class="",e&&"undefined"!=typeof e.optin_provider?("custom_content"==e.optin_provider&&(_.isTrue(e.customize_size)&&(e.custom_size_class="wph-modal--custom",e.custom_size_attr+="data-custom_width="+e.custom_width+" data-custom_height="+e.custom_height),_.isTrue(e.border)&&(e.custom_size_attr+=" data-border="+e.border_weight)),e):e},enable_body_scroll:function(t){if(t&&"undefined"!=typeof t.optin_provider&&"undefined"!=typeof t.type&&"custom_content"==t.optin_provider&&"popup"==t.type){if("undefined"==typeof this.type_data.allow_scroll_page)return;_.isTrue(this.type_data.allow_scroll_page)?e("html").addClass("can-scroll"):e("html").addClass("no-scroll")}},fire_conversion_event:function(t){var i=e(t.target).hasClass("wph-modal--cta")?"cta":"form";Hustle.Events.trigger("cc_modal_converted",this,i),this.trigger("converted",this,i)},never_see_again:function(t){t&&t.preventDefault(),window.hasOwnProperty("optin_vars")||Hustle.cookie.set(Hustle.consts.Never_See_Aagain_Prefix+this.model.get("type")+"-"+this.model.get("id"),this.model.get("id"),this.type_data.expiration_days),t&&!e(t.target).hasClass("wph-icon i-close")&&this.hide()},on_form_submit:function(t){var i=this,s=e(t.target),n=this.type_data.on_submit;switch(n){case"close":i.hide();break;case"redirect":window.location.replace(s.attr("action"));break;case"default":}}})}),function(e){"use strict";Hustle.Events.on("view.rendered",function(e){e instanceof Backbone.View&&e.$(".wpmuiSelect").wpmuiSelect()})}(jQuery),Hustle.define("Delete_Confirmation",function(e){"use strict";return Backbone.View.extend({template:Optin.template("hustle-delete-module-confirmation-tpl"),className:"hustle-delete-module-confirmation",tagName:"span",opts:{id:"",nonce:"",action:"",url:ajaxurl},events:{"click .hustle-delete-module-confirm":"confirm","click .hustle-delete-module-cancel":"cancel"},initialize:function(e){return this.opts=_.extend({},this.opts,e),this.render()},render:function(){return this.$el.html(this.template()),this},confirm:function(t){t.preventDefault(),t.stopPropagation();var i=this,s=this.$(t.target),n=e("<span class='button-spinner'>"),o=s.outerWidth();s.append(n).animate({width:o+.2*o}).attr("disabled",!0),e.ajax({url:this.opts.url,type:"POST",data:{action:this.opts.action,_ajax_nonce:this.opts.nonce,id:this.opts.id},complete:function(){s.animate({width:o}).attr("disabled",!1).find(".button-spinner").remove()},success:function(e){i.opts.onSuccess&&_.isFunction(i.opts.onSuccess)&&i.opts.onSuccess.call(this,e,i)}})},cancel:function(e){e.preventDefault(),e.stopPropagation(),this.remove()}})}),Hustle.define("Media_Holder",function(){"use strict";return Backbone.View.extend({template:Optin.template("hustle-media-holder-tpl"),media_frame:!1,options:{attribute:"image",title:optin_vars.messages.media_uploader.select_or_upload,button_text:optin_vars.messages.media_uploader.use_this_image,multiple:!1},events:{"click .wph-media--add":"open","click .wph-button--dots":"toggle_options","click .i-close":"toggle_options","click .wpoi-swap-image-button":"swap_image","click .wpoi-delete-image-button":"delete_image"},initialize:function(e){if(this.options=_.extend({},this.options,e),!this.model||!this.options.attribute)throw new Error("Undefined model or attribute");jQuery(document).on("click",this.close_media_options),this.render()},render:function(){var e=this.template({image:this.model.get(this.options.attribute)});return this.setElement(e),this.define_media_frame(),this},define_media_frame:function(){var e=this,t=this.$(".wph-media--preview"),i=this.$(".wph-media--holder"),s=this.$(".wph-media--options");this.media_frame=wp.media({title:e.options.title,button:{text:e.options.button_text},multiple:e.options.multiple}).on("select",function(){var n=e.media_frame.state().get("selection").first().toJSON();n&&n.url&&(t.css("background-image","url({url})".replace("{url}",n.url)),i.addClass("has-image"),e.model.set(e.options.attribute,n.url),s.removeClass("hidden"),e.$(".wph-media--add").addClass("hidden"))})},open:function(e){e.preventDefault();var t=this.$(".wph-media--holder");t.removeClass("has-image"),this.media_frame.open()},toggle_options:function(){this.$("wph-media--list").toggleClass("wph-open"),this.$(".wph-media--items").toggleClass("hidden"),this.$(".svg-triangle").toggleClass("hidden")},close_media_options:function(e){var t=jQuery(e.target),i=t.closest(".wph-media--list");if(0===i.length&&!t.hasClass("wph-button wph-button--dots")){var s=jQuery(".wph-media--list"),n=s.find(".wph-media--items"),o=s.find(".svg-triangle");n.hasClass("hidden")||n.addClass("hidden"),o.hasClass("hidden")||o.addClass("hidden")}},swap_image:function(e){e.preventDefault(),this.media_frame&&(this.media_frame.open(),this.toggle_options())},delete_image:function(e){e.preventDefault();var t=this.$(".wph-media--preview");this.model.set(this.options.attribute,""),t.css("background-image","url('')"),this.toggle_options(),this.$(".wph-media--add").removeClass("hidden"),this.$(".wph-media--options").addClass("hidden")}})}),Hustle.define("Mixins.Model_Updater",function(e,t,i){"use strict";return{init_mix:function(){this.events=_.extend({},this.events,this._events),this.delegateEvents()},_events:{"change input[type='text']":"_update_text","change input[type='number']":"_update_text","change input[type='checkbox']":"_update_checkbox","change input[type=radio]":"_update_radios","change select":"_update_select"},_update_text:function(t){var i=e(t.target),s=i.data("attribute"),n=this[i.data("model")||"model"],o=_.isTrue(i.data("silent"))?{silent:!0}:{};n&&s&&(t.stopPropagation(),n.set.call(n,s,t.target.value,o))},_update_checkbox:function(t){var i=e(t.target),s=i.data("attribute"),n=this[i.data("model")||"model"],o=_.isTrue(i.data("silent"))?{silent:!0}:{};n&&s&&(t.stopPropagation(),n.set.call(n,s,i.is(":checked")?1:0,o))},_update_radios:function(t){var i=e(t.target),s=i.data("attribute"),n=this[i.data("model")||"model"],o=_.isTrue(i.data("silent"))?{silent:!0}:{};n&&s&&(t.stopPropagation(),n.set.call(n,s,t.target.value,o))},_update_select:function(t){var i=e(t.target),s=i.data("attribute"),n=this[i.data("model")||"model"],o=_.isTrue(i.data("silent"))?{silent:!0}:{};n&&s&&(t.stopPropagation(),n.set.call(n,s,i.val(),o))}}}),Hustle.define("Settings.Conditions_View",function(e){"use strict";return Hustle.View.extend({template:Optin.template("wpoi-wizard-popup-conditions"),handle_tpl:Optin.template("wpoi-wizard-popup-conditions-handle"),className:"wph-conditions",events:{"click .wph-conditions--side .wph-conditions--item:not(.disabled)":"toggle_condition","click .wph-conditions--side .wph-conditions--item:not(.disabled) span":"toggle_condition","click .wph-conditions--item header":"toggle_panel"},init:function(e){this.type=e.type,this.active_conditions={},this.listenTo(this.model,"change",this.toggle_empty_message),this.render()},render:function(){var e=this.model.toJSON();this.$el.html(this.template({type_name:this.type})),_.each(Optin.View.Conditions,function(t,i){var s=this.handle_tpl({label:this.get_label(i),id:i,cid:this.get_condition_cid(i),active_class:e[i]?"added":"",icon_class:e[i]?"wpoi-remove":"wpoi-add"});this.$(".wph-conditions--side .wph-conditions--items").append(s)},this),_.each(e,function(e,t){this.add_condition_panel(t)},this),this.toggle_empty_message()},get_condition_cid:function(e){return this.type+"_"+e},get_label:function(e){var t=optin_vars.messages.settings[this.type]?optin_vars.messages.settings[this.type]:this.type;return optin_vars.messages.conditions[e]?optin_vars.messages.conditions[e].replace("{type_name}",t):e},take_care_of_connected_conditions:function(e){e.disable&&e.disable.length&&_.each(e.disable,function(e,t){var i=this.$("#"+this.get_condition_cid(e));i.toggleClass("disabled")},this)},add_condition:function(e,t){var i=this.add_condition_panel(e);return t.addClass("added"),t.find("span").addClass("wpoi-remove"),t.find("span").removeClass("wpoi-add"),this.model.set(e,i.get_configs()),this.model.toJSON()},remove_condition:function(e,t,i){this.take_care_of_connected_conditions(t),t.off("change:update_label"),t.remove(),delete this.active_conditions[e],i.removeClass("added"),i.find("span").removeClass("wpoi-remove"),i.find("span").addClass("wpoi-add"),this.model.unset(e)},add_condition_panel:function(e){if("undefined"!=typeof Optin.View.Conditions[e]){var t=this.active_conditions[e]=new Optin.View.Conditions[e]({model:this.model,type:this.type});_.isEmpty(this.active_conditions)&&this.$(".wph-conditions--box .wph-conditions--items").html(""),this.take_care_of_connected_conditions(t);var i=this;return t.on("change:update_label",function(){i.trigger("change:update_view_label",i)}),this.$(".wph-conditions--box .wph-conditions--items").append(t.$el),t}},toggle_condition:function(e){e.stopPropagation();var t=this.$(e.target).data("id")||this.$(e.target).closest(".wph-conditions--item").data("id"),i=this.$("#"+this.get_condition_cid(t)),s=this.active_conditions[t];s?(this.remove_condition(t,s,i),this.trigger("condition_removed",this,t,s)):(this.add_condition(t,i),this.trigger("condition_added",this,t,s)),this.trigger("toggle_condition",this,t,s)},toggle_empty_message:function(){this.model.isEmpty()?this.$(".wph-conditions--empty").show():this.$(".wph-conditions--empty").hide()},toggle_panel:_.debounce(function(t){var i=e(t.target),s=i.closest(".wph-conditions--item"),n=s.find("section");n.slideToggle(300,function(){s.toggleClass("wph-conditions--closed wph-conditions--open")})},300),get_conditions_labels:function(){var e=_.pluck(this.active_conditions,"label"),t=Hustle.create_template("<span>{{label}}</span>");return e.length?e.map(function(e){return t({label:e})}).join(", "):optin_vars.messages.condition_labels.everywhere},get_all_conditions_labels:function(){var e=this.active_conditions,t={posts:{label:optin_vars.messages.condition_labels.all_posts},pages:{label:optin_vars.messages.condition_labels.all_pages},categories:{label:optin_vars.messages.condition_labels.all_categories},tags:{label:optin_vars.messages.condition_labels.all_tags}},i=[];for(var s in t)"undefined"==typeof e[s]&&i.push(t[s].label);var n=_.pluck(e,"label"),o=Hustle.create_template("<span>{{label}}</span>");return n=n.concat(i),n.length?n.map(function(e){return o({label:e})}).join(", "):optin_vars.messages.condition_labels.everywhere}})}),function(e){"use strict";Optin.View.Conditions=Optin.View.Conditions||{};var t=Hustle.View.extend({condition_id:"",className:"wph-conditions--item wph-conditions--open",_template:Optin.template("wpoi-wizard-popup-conditions-item"),template:!1,_defaults:{type_name:"",condition_name:"",label:""},_events:{"change input":"change_input","change textarea":"change_input","change select":"change_input"},init:function(t){return this.type=t.type,this.id=this.type+"-"+this.condition_id,this.template="undefined"!=typeof this.cpt?Optin.template("wpoi-condition-post_type"):Optin.template("wpoi-condition-"+this.condition_id),this._defaults={type_name:optin_vars.messages.settings[this.type]?optin_vars.messages.settings[this.type]:this.type,condition_name:optin_vars.messages.conditions[this.condition_id]?optin_vars.messages.conditions[this.condition_id]:this.condition_id},this.data=this.get_data(),this.render(),this.events=e.extend(!0,{},this.events,this._events),this.delegateEvents(),this.on_init&&_.isFunction(this.on_init)&&this.on_init.apply(this,arguments),this},get_data:function(){return _.extend({},this._defaults,this.defaults,this.model.get(this.condition_id),{type:this.type})},get_title:function(){return this.title.replace("{type_name}",this.data.type_name)},get_body:function(){return"function"==typeof this.body?this.body.apply(this,arguments):this.body.replace("{type_name}",this.data.type_name)},get_header:function(){return""},render:function(){var e=this._template(_.extend({},{title:this.get_title(),body:this.get_body(),header:this.get_header()},this._defaults,{type:this.type}));return this.$el.html(e),this.rendered&&"function"==typeof this.rendered&&this.rendered.apply(this,arguments),this},update_attribute:function(e,t){this.data=this.model.get(this.condition_id),this.data[e]=t,this.model.set(this.condition_id,this.data),this.model.trigger("change",t)},get_attribute:function(e){var t=this.model.get(this.condition_id);return!(!t||!t[e])&&t[e]},change_input:function(t){var i=t.target,s=i.getAttribute("data-attribute"),n=e(i),o=n.is(".js-wpoi-select")?n.val():t.target.value;return!n.is(".select2-search__field")&&(_.delay(function(){var t=e(".select2-results").parents(".select2-container");t.length&&t.remove()},500),this.update_attribute(s,o))},get_configs:function(){return this.defaults||!0}}),i=function(){e(".wph-conditions--items").data("select2ScrollPosition",{})},s=function(t){var i=["all"];t.params&&t.params.args&&t.params.args.data&&t.params.args.data.id&&"all"===t.params.args.data.id||(i=e(this).val(),i&&-1!==i.indexOf("all")?i.splice(i.indexOf("all"),1):i=(i||[]).concat([t.params.args.data.id]),i&&i.length||(i=[t.params.args.data.id])),e(this).val(i).trigger("change")},n={events:{"change input[type='radio']":"set_current_li"},set_current_li:function(t){var i=e(t.target),s=i.closest("li");s.siblings().removeClass("current"),s.toggleClass("current",i.is(":checked"))}};Optin.View.Conditions.posts=t.extend(_.extend({},n,{condition_id:"posts",title:optin_vars.messages.conditions.posts,label:optin_vars.messages.condition_labels.posts,defaults:{filter_type:"only",posts:[]},on_init:function(){this.listenTo(this.model,"change",this.render),this.update_label()},get_header:function(){return this.update_label(),this.trigger("change:update_label",this),_.contains(this.get_attribute("posts"),"all")?"only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.all_posts:optin_vars.messages.condition_labels.no_posts:this.get_attribute("posts").length?("only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.only_on_these_posts:optin_vars.messages.condition_labels.except_these_posts).replace("{number}",this.get_attribute("posts").length):"only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.no_posts:optin_vars.messages.condition_labels.all_posts},update_label:function(){this.get_attribute("posts").length&&!_.contains(this.get_attribute("posts"),"all")?this.label=("only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.number_posts:optin_vars.messages.condition_labels.except_these_posts).replace("{number}",this.get_attribute("posts").length?this.get_attribute("posts").length:0):_.contains(this.get_attribute("posts"),"all")?this.label="only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.all_posts:optin_vars.messages.condition_labels.no_posts:this.label="only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.no_posts:optin_vars.messages.condition_labels.all_posts},body:function(){return this.template(this.get_data())},rendered:function(){this.$(".js-wpoi-select").wpmuiSelect({tags:"true",width:"100%",createTag:function(){return!1}}).on("select2:selecting",s).on("select2:selecting",i).on("select2:unselect",i)}})),Optin.View.Conditions.pages=t.extend(_.extend({},n,{condition_id:"pages",title:optin_vars.messages.conditions.pages,label:optin_vars.messages.condition_labels.pages,defaults:{filter_type:"only",pages:[]},on_init:function(){this.listenTo(this.model,"change",this.render),this.update_label()},get_header:function(){return this.update_label(),this.trigger("change:update_label",this),_.contains(this.get_attribute("pages"),"all")?"only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.all_pages:optin_vars.messages.condition_labels.no_pages:this.get_attribute("pages").length?("only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.only_on_these_pages:optin_vars.messages.condition_labels.except_these_pages).replace("{number}",this.get_attribute("pages").length):"only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.no_pages:optin_vars.messages.condition_labels.all_pages},update_label:function(){this.get_attribute("pages").length&&!_.contains(this.get_attribute("pages"),"all")?this.label=("only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.number_pages:optin_vars.messages.condition_labels.except_these_pages).replace("{number}",this.get_attribute("pages").length?this.get_attribute("pages").length:0):_.contains(this.get_attribute("pages"),"all")?this.label="only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.all_pages:optin_vars.messages.condition_labels.no_pages:this.label="only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.no_pages:optin_vars.messages.condition_labels.all_pages},body:function(){return this.template(this.get_data())},rendered:function(){this.$(".js-wpoi-select").wpmuiSelect({tags:"true",width:"100%",createTag:function(){return!1}}).on("select2:selecting",s).on("select2:selecting",i).on("select2:unselect",i)}})),_.each(optin_vars.post_types,function(e,o){var a=e.label.toLowerCase();Optin.View.Conditions[e.label]=t.extend(_.extend({},n,{condition_id:e.label,title:e.label,label:optin_vars.messages.condition_labels.posts,cpt:!0,defaults:{filter_type:"only",selected_cpts:[],post_type:o,post_type_label:e.label},on_init:function(){this.listenTo(this.model,"change",this.render),this.update_label()},get_header:function(){return this.update_label(),this.trigger("change:update_label",this),_.contains(this.get_attribute("selected_cpts"),"all")?"only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.all+" "+a:optin_vars.messages.condition_labels.no+" "+a:this.get_attribute("selected_cpts").length?("only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.only_on_these_posts:optin_vars.messages.condition_labels.except_these_posts).replace("{number}",this.get_attribute("selected_cpts").length).replace("posts",a):"only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.no+" "+a:optin_vars.messages.condition_labels.all+" "+a},update_label:function(){this.get_attribute("selected_cpts").length&&!_.contains(this.get_attribute("selected_cpts"),"all")?this.label=("only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.number_posts:optin_vars.messages.condition_labels.except_these_posts).replace("{number}",this.get_attribute("selected_cpts").length?this.get_attribute("selected_cpts").length:0).replace("posts",a):_.contains(this.get_attribute("selected_cpts"),"all")?this.label="only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.all+" "+a:optin_vars.messages.condition_labels.no+" "+a:this.label="only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.no+" "+a:optin_vars.messages.condition_labels.all+" "+a},body:function(){return this.template(this.get_data())},rendered:function(){this.$(".js-wpoi-select").wpmuiSelect({tags:"true",width:"100%",createTag:function(){return!1}}).on("select2:selecting",s).on("select2:selecting",i).on("select2:unselect",i)}}))}),Optin.View.Conditions.categories=t.extend(_.extend({},n,{condition_id:"categories",title:optin_vars.messages.conditions.categories,label:optin_vars.messages.condition_labels.categories,defaults:{filter_type:"only",categories:[]},on_init:function(){this.listenTo(this.model,"change",this.render),this.update_label()},get_header:function(){return this.update_label(),this.trigger("change:update_label",this),_.contains(this.get_attribute("categories"),"all")?"only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.all_categories:optin_vars.messages.condition_labels.no_categories:this.get_attribute("categories").length?("only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.only_on_these_categories:optin_vars.messages.condition_labels.except_these_categories).replace("{number}",this.get_attribute("categories").length):"only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.no_categories:optin_vars.messages.condition_labels.all_categories},update_label:function(){this.get_attribute("categories").length&&!_.contains(this.get_attribute("categories"),"all")?this.label=("only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.number_categories:optin_vars.messages.condition_labels.except_these_categories).replace("{number}",this.get_attribute("categories").length?this.get_attribute("categories").length:0):_.contains(this.get_attribute("categories"),"all")?this.label="only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.all_categories:optin_vars.messages.condition_labels.no_categories:this.label="only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.no_categories:optin_vars.messages.condition_labels.all_categories},body:function(){return this.template(this.get_data())},rendered:function(){this.$(".js-wpoi-select").wpmuiSelect({tags:"true",width:"100%",createTag:function(){return!1}}).on("select2:selecting",i).on("select2:unselect",i)}})),Optin.View.Conditions.tags=t.extend(_.extend({},n,{condition_id:"tags",title:optin_vars.messages.conditions.tags,label:optin_vars.messages.condition_labels.tags,defaults:{filter_type:"only",tags:[]},on_init:function(){this.listenTo(this.model,"change",this.render),this.update_label()},get_header:function(){return this.update_label(),this.trigger("change:update_label",this),_.contains(this.get_attribute("tags"),"all")?"only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.all_tags:optin_vars.messages.condition_labels.no_tags:this.get_attribute("tags").length?("only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.only_on_these_tags:optin_vars.messages.condition_labels.except_these_tags).replace("{number}",this.get_attribute("tags").length):"only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.no_tags:optin_vars.messages.condition_labels.all_tags},update_label:function(){this.get_attribute("tags").length&&!_.contains(this.get_attribute("tags"),"all")?this.label=("only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.number_tags:optin_vars.messages.condition_labels.except_these_tags).replace("{number}",this.get_attribute("tags").length?this.get_attribute("tags").length:0):_.contains(this.get_attribute("tags"),"all")?this.label="only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.all_tags:optin_vars.messages.condition_labels.no_tags:this.label="only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.no_tags:optin_vars.messages.condition_labels.all_tags;
},body:function(){return this.template(this.get_data())},rendered:function(){this.$(".js-wpoi-select").wpmuiSelect({tags:"true",width:"100%",createTag:function(){return!1}}).on("select2:selecting",i).on("select2:unselect",i)}})),Optin.View.Conditions.visitor_logged_in=t.extend({condition_id:"visitor_logged_in",disable:["visitor_not_logged_in"],title:optin_vars.messages.conditions.visitor_logged_in,label:optin_vars.messages.condition_labels.visitor_logged_in,body:optin_vars.messages.conditions_body.visitor_logged_in}),Optin.View.Conditions.visitor_not_logged_in=t.extend({condition_id:"visitor_not_logged_in",disable:["visitor_logged_in"],title:optin_vars.messages.conditions.visitor_not_logged_in,label:optin_vars.messages.condition_labels.visitor_not_logged_in,body:optin_vars.messages.conditions_body.visitor_not_logged_in}),Optin.View.Conditions.shown_less_than=t.extend({condition_id:"shown_less_than",title:optin_vars.messages.conditions.shown_less_than,label:optin_vars.messages.condition_labels.shown_less_than,defaults:{less_than:1},body:function(){return this.template(this.get_data())}}),Optin.View.Conditions.only_on_mobile=t.extend({condition_id:"only_on_mobile",disable:["not_on_mobile"],title:optin_vars.messages.conditions.only_on_mobile,label:optin_vars.messages.condition_labels.only_on_mobile,body:optin_vars.messages.conditions_body.only_on_mobile}),Optin.View.Conditions.not_on_mobile=t.extend({condition_id:"not_on_mobile",disable:["only_on_mobile"],title:optin_vars.messages.conditions.not_on_mobile,label:optin_vars.messages.condition_labels.not_on_mobile,body:optin_vars.messages.conditions_body.not_on_mobile}),Optin.View.Conditions.from_specific_ref=t.extend({condition_id:"from_specific_ref",disable:["not_from_specific_ref"],title:optin_vars.messages.conditions.from_specific_ref,label:optin_vars.messages.condition_labels.from_specific_ref,defaults:{refs:""},body:function(){return this.template(this.get_data())}}),Optin.View.Conditions.not_from_specific_ref=t.extend({condition_id:"not_from_specific_ref",disable:["from_specific_ref"],title:optin_vars.messages.conditions.not_from_specific_ref,label:optin_vars.messages.condition_labels.not_from_specific_ref,defaults:{refs:""},body:function(){return this.template(this.get_data())}}),Optin.View.Conditions.not_from_internal_link=t.extend({condition_id:"not_from_internal_link",title:optin_vars.messages.conditions.not_from_internal_link,label:optin_vars.messages.condition_labels.not_from_internal_link,body:optin_vars.messages.conditions_body.not_from_internal_link}),Optin.View.Conditions.from_search_engine=t.extend({condition_id:"from_search_engine",title:optin_vars.messages.conditions.from_search_engine,label:optin_vars.messages.condition_labels.from_search_engine,body:optin_vars.messages.conditions_body.from_search_engine}),Optin.View.Conditions.on_specific_url=t.extend({condition_id:"on_specific_url",disable:["not_on_specific_url"],title:optin_vars.messages.conditions.on_specific_url,label:optin_vars.messages.condition_labels.on_specific_url,defaults:{urls:""},body:function(){return this.template(this.get_data())}}),Optin.View.Conditions.not_on_specific_url=t.extend({condition_id:"not_on_specific_url",disable:["on_specific_url"],title:optin_vars.messages.conditions.not_on_specific_url,label:optin_vars.messages.condition_labels.not_on_specific_url,defaults:{urls:""},body:function(){return this.template(this.get_data())}}),Optin.View.Conditions.visitor_has_commented=t.extend({condition_id:"visitor_has_commented",disable:["visitor_has_never_commented"],title:optin_vars.messages.conditions.visitor_has_commented,label:optin_vars.messages.condition_labels.visitor_has_commented,body:optin_vars.messages.conditions_body.visitor_has_commented}),Optin.View.Conditions.visitor_has_never_commented=t.extend({condition_id:"visitor_has_never_commented",disable:["visitor_has_commented"],title:optin_vars.messages.conditions.visitor_has_never_commented,label:optin_vars.messages.condition_labels.visitor_has_never_commented,body:optin_vars.messages.conditions_body.visitor_has_never_commented}),Optin.View.Conditions.in_a_country=t.extend({condition_id:"in_a_country",disable:["not_in_a_country"],title:optin_vars.messages.conditions.in_a_country,label:optin_vars.messages.condition_labels.in_a_country,defaults:{countries:""},body:function(){return this.template(this.get_data())},rendered:function(){this.$(".js-wpoi-select").val(this.get_attribute("countries")).wpmuiSelect().on("select2:selecting",i).on("select2:unselect",i)}}),Optin.View.Conditions.not_in_a_country=t.extend({condition_id:"not_in_a_country",disable:["in_a_country"],title:optin_vars.messages.conditions.not_in_a_country,label:optin_vars.messages.condition_labels.not_in_a_country,defaults:{countries:""},body:function(){return this.template(this.get_data())},rendered:function(){this.$(".js-wpoi-select").val(this.get_attribute("countries")).wpmuiSelect().on("select2:selecting",i).on("select2:unselect",i)}})}(jQuery),Hustle.define("Settings.Display_Triggers_View",function(e,t,i){"use strict";return Hustle.View.extend(_.extend({},Hustle.get("Mixins.Model_Updater"),{template:Optin.template("wpoi-settings-display-triggers-tpl"),events:{"click .tabs-header label":"change_tab"},init:function(e){this.type=e.type,this.listenTo(this.model,"change:on_adblock",this.hide_adblock_options_on_toggle),this.render()},render:function(){return this.$el.html(this.template(this.get_data())),this.hide_adblock_options_on_toggle(),this},get_data:function(){var e={};return e.type=this.type,_.extend({},e,this.model.toJSON())},change_tab:function(e){e.preventDefault();var t=this.$(e.target),i=t.parent("li"),s=this.$(t.attr("href")),n=t.find("input[type='radio']");this.$(".tabs-header li").removeClass("current"),this.$(".tabs-content").removeClass("current"),i.addClass("current"),s.addClass("current"),n.prop("checked",!0),this.model.set("trigger",n.val())},hide_adblock_options_on_toggle:function(){_.isTrue(this.model.get("on_adblock"))?this.$(".wpoi-popup-trigger-on-adblock-option").show():this.$(".wpoi-popup-trigger-on-adblock-option").hide()}}))}),Hustle.define("Settings.E_News",function(e){"use strict";return Backbone.View.extend({el:"#enews-sync-box",back_tpl:Optin.template("wpoi-e-newsletter-box-back"),initial_html:"",events:{"click .optin-enews-sync-setup":"setup","click .optin-enews-sync-cancel":"cancel","click .optin-enews-sync-save":"save","click .optin-enews-sync-toggle":"toggle","click .optin-enews-sync-edit":"setup"},initialize:function(){this.initial_html=this.$el.html()},setup:function(t){t.preventDefault();var i=this,s=e(t.target),n=s.data("id"),o=s.data("nonce");s.hasClass("optin-enews-sync-edit");e.ajax({url:ajaxurl,type:"GET",data:{action:"inc_opt_get_enews_sync_setup",_ajax_nonce:o,id:n},success:function(e){e.success&&i.$el.html(i.back_tpl(e.data))},error:function(e){}})},cancel:function(e){e.preventDefault(),this.$el.html(this.initial_html)},save:function(t){t.preventDefault();var i=this,s=e(t.target),n=s.data("id"),o=[],a=s.data("nonce");this.$(".wpoi-e-newsletter-group").each(function(e,t){t.checked&&o.push(t.value)}),e.ajax({url:ajaxurl,type:"POST",data:{action:"inc_opt_save_enews_sync_setup",_ajax_nonce:a,id:n,groups:o},success:function(e){e.success&&i.$el.html(e.data.html)},error:function(e){}})},toggle:function(t){var i=this,s=e(t.target),n=s.data("id"),o=s.data("nonce"),a=s.is(":checked");e.ajax({url:ajaxurl,type:"POST",data:{action:"inc_opt_toggle_enews_sync",_ajax_nonce:o,id:n,state:a},success:function(e){e.success&&(s.attr("checked",a),i.initial_html=i.$el.html())}})}})}),Hustle.define("Settings.Modules_Activity",function(e){"use strict";return Backbone.View.extend({el:"#modules-activity",events:{"change .hustle-for-admin-user-toggle":"toggle_for_user","change .hustle-for-logged-in-user-toggle":"toggle_for_user"},initialize:function(){},toggle_for_user:function(t){var i=this.$(t.target),s=i.data("id"),n=i.data("nonce"),o=i.data("user");i.attr("disabled",!0),e.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_toggle_module_for_user",id:s,_ajax_nonce:n,user_type:o},complete:function(e,t){i.attr("disabled",!1)},success:function(e){e.success||i.prop("checked",!i.is(":checked"))},error:function(){i.prop("checked",!i.is(":checked"))}})}})}),Hustle.define("Settings.Services_Edit_Modal",function(e){"use strict";return Backbone.View.extend({template:Hustle.template("wph-edit-provider-modal-tpl"),id:"wph-edit-provider-modal",events:{"click .i-close":"close","click .js-wph-button-cancel":"close","change #wph-provider-edit-modal-provider":"get_provider_options","click #wph-edit-service-save":"save_settings","submit form":"save_settings"},provider_options_nonce:!1,initialize:function(){this.render()},render:function(){var t=this;this.$el.html(this.template()).appendTo("body"),e.ajax({url:ajaxurl,type:"get",data:{action:"hustle_get_providers_edit_modal_content",id:t.model.get("id"),source:t.model.get("source"),_ajax_nonce:t.model.get("nonce")},success:function(e){e.success&&(t.$(".wph-edit-provider-modal-content").html(e.data.html),t.provider_options_nonce=e.data.provider_options_nonce,Hustle.Events.trigger("view.rendered",t))}})},get_provider_options:function(t){var i=this,s=this.$(t.target),n=this.$("#optin_new_provider_account_details"),o=this.$("#optin_new_provider_account_options");n.empty(),o.empty(),e.ajax({url:ajaxurl,type:"get",data:{action:"render_provider_account_options",provider_id:s.val(),_ajax_nonce:i.provider_options_nonce,optin:i.model.get("id")},success:function(e){e.success&&(n.html(e.data),Hustle.Events.trigger("view.rendered",i))}})},close:function(e){e.preventDefault(),this.remove()},hide:function(){},show:function(){},save_settings:function(t){t.preventDefault();var i=this.$(t.target),s=i.data("nonce"),n=this.$("#wph-provider-edit-modal-provider"),o=i.closest("form");e.ajax({url:ajaxurl,type:"post",data:{action:"hustle_save_providers_edit_modal",provider_id:n.val(),_ajax_nonce:s,id:this.model.get("id"),source:this.model.get("source"),form:o.serialize()},success:function(e){}})}})}),Hustle.define("Settings.Services",function(e){"use strict";return Backbone.View.extend({el:"#providers-edit-box",Modal_View:Hustle.get("Settings.Services_Edit_Modal"),modal:!1,events:{"click .wph-providers-edit":"open_edit_modal"},open_edit_modal:function(e){var t=this.$(e.target),i=t.data("id"),s=t.data("source"),n=t.data("nonce");this.modal=new this.Modal_View({model:new Backbone.Model({id:i,nonce:n,source:s})})}})}),function(e,t){"use strict";e(document).on("click",".wpoi-listing-wrap header.can-open .toggle, .wpoi-listing-wrap header.can-open .toggle-label",function(e){e.stopPropagation()}),e(".accordion header .optin-delete-optin, .accordion header .edit-optin, .wpoi-optin-details tr .button-edit").hide().css({transition:"none"}),e(document).on({mouseenter:function(){var t=e(this);t.find(".optin-delete-optin, .edit-optin").stop().fadeIn("fast")},mouseleave:function(){var t=e(this);t.find(".toggle-checkbox").removeProp("disabled"),t.find(".edit-optin").removeProp("disabled"),t.removeClass("disabled"),t.find(".optin-delete-optin, .edit-optin, .delete-optin-confirmation").stop().fadeOut("fast")}},".accordion header"),e(document).on({mouseenter:function(){var t=e(this);t.find(".button-edit").stop().fadeIn("fast")},mouseleave:function(){var t=e(this);t.find(".button-edit").stop().fadeOut("fast")}},".wpoi-optin-details tr"),e(document).on("click",".wpoi-tabs-menu a",function(t){t.preventDefault();var i=e(this).attr("tab");Optin.router.navigate(i,!0)}),e(document).on("click",".edit-optin",function(t){t.stopPropagation(),t.preventDefault(),window.location.href=e(this).attr("href")}),e(document).on("click",".wpoi-type-edit-button",function(t){t.preventDefault();var i=e(this).data("id"),s=e(this).data("type");window.location.href="admin.php?page=inc_optin&optin="+i+"#display/"+s}),e(document).on("click","*[for]",function(t){var i=e(this),s=i.attr("for"),n=e("#"+s);!i.is("label")&&n.length&&(n.trigger("change"),n.trigger("click"))}),e("#wpoi-complete-message").fadeIn(),e(document).on("click","#wpoi-complete-message .next-button button",function(t){e("#wpoi-complete-message").fadeOut()}),e(document).on("click",".wpoi-listing-page .wpoi-listing-wrap header.can-open",function(t){e(this).find(".open").trigger("click")}),e(document).on("click",".wpoi-listing-page .wpoi-listing-wrap .can-open .open",function(t){t.stopPropagation();var i=e(this),s=i.closest(".wpoi-listing-wrap"),n=s.find("section"),o=e(".wpoi-listing-wrap").not(s),a=e(".wpoi-listing-wrap section").not(n);a.slideUp(300,function(){a.removeClass("open")}),o.find(".dev-icon").removeClass("dev-icon-caret_up").addClass("dev-icon-caret_down"),n.slideToggle(300,function(){s.toggleClass("open"),s.find(".dev-icon").toggleClass("dev-icon-caret_up dev-icon-caret_down")})}),Optin.decorate_number_inputs=function(t){var i=t&&t.$el?t.$el.find(".wph-input--number input"):e(".wph-input--number input"),s=Hustle.create_template('<div class="wph-nbr--nav"><div class="wph-nbr--button wph-nbr--up {{disabled}}">+</div><div class="wph-nbr--button wph-nbr--down {{disabled}}">-</div></div>');i.each(function(){var t=e(this),i=t.is(":disabled")?"disabled":"";t.siblings(".wph-nbr--nav").length||t.after(s({disabled:i}))})},Hustle.Events.on("view.rendered",Optin.decorate_number_inputs),function(){e(document).on("click",".wph-nbr--up:not(.disabled)",function(t){var i,s=e(this),n=s.closest(".wph-input--number"),o=n.find("input"),a=parseFloat(o.val()),l=(o.attr("min"),o.attr("max"));i=a>=l?a:a+1,i!==a&&o.val(i).trigger("change")}),e(document).on("click",".wph-nbr--down:not(.disabled)",function(t){var i,s=e(this),n=s.closest(".wph-input--number"),o=n.find("input"),a=parseFloat(o.val()),l=o.attr("min");o.attr("max");i=a<=l?a:a-1,i!==a&&o.val(i).trigger("change")})}(),function(){function t(){var t=e(window).scrollTop(),i=e(".wph-sticky--anchor");i.length&&(i=i.offset().top,t>i?(e(".wph-preview--eye").addClass("wph-sticky--element"),e(".wph-sticky--anchor").height(e(".wph-preview--eye").outerHeight())):(e(".wph-preview--eye").removeClass("wph-sticky--element"),e(".wph-sticky--anchor").height(0)))}e(function(){e(window).scroll(t),t()})}()}(jQuery,document),Hustle.define("Model",function(){"use strict";return Backbone.Model.extend({initialize:function(){this.on("change",this.user_has_change,this),Backbone.Model.prototype.initialize.apply(this,arguments)},user_has_change:function(){Optin.hasChanges=!0}})}),Hustle.define("Models.M",function(){"use strict";return Hustle.get("Model").extend({toJSON:function(){var e=_.clone(this.attributes);for(var t in e)(e[t]instanceof Backbone.Model||e[t]instanceof Backbone.Collection)&&(e[t]=e[t].toJSON());return e},set:function(e,t,i){if("string"==typeof e&&e.indexOf(".")!==-1){var s=e.split(".")[0],n=e.split(".")[1],o=this.get(s);o&&o instanceof Backbone.Model&&(o.set(n,t,i),this.trigger("change:"+e,e,t,i),this.trigger("change:"+s,e,t,i))}else Backbone.Model.prototype.set.call(this,e,t,i)},get:function(e){if("string"==typeof e&&e.indexOf(".")!==-1){var t=e.split(".")[0],i=e.split(".")[1];return this.get(t).get(i)}return Backbone.Model.prototype.get.call(this,e)}})}),Optin.Model=Hustle.get("Models.M").extend({defaults:{optin_name:optin_vars.messages.model.defaults.optin_name,optin_title:optin_vars.messages.model.defaults.optin_title,optin_message:optin_vars.messages.model.defaults.optin_message,optin_provider:"",api_key:"",mail_list:"",active:1,test_mode:0,save_to_local:0,service_source:"existing"},validate_first_step:function(e){var t=[];return e=e||this.attributes,e.optin_name&&!e.optin_name.isEmpty()||t.push({name:"name",message:optin_vars.messages.model.errors.name}),1!=e.test_mode&&1!=e.save_to_local&&(e.optin_provider&&!e.optin_provider.isEmpty()||t.push({name:"provider",message:optin_vars.messages.model.errors.provider}),e.api_key&&!e.api_key.isEmpty()||t.push({name:"api_key",message:optin_vars.messages.model.errors.api_key}),e.optin_mail_list&&!e.optin_mail_list.isEmpty()||t.push({name:"mail_list",message:optin_vars.messages.model.errors.mail_list})),_(t)}}),Optin.Models.Color_Palette=Hustle.get("Models.M").extend({defaults:{_id:"",label:"",main_background:"",form_background:"",button_background:"",button_label_color:"",title_color:"",content_color:"",fields_background:"",fields_color:""}}),Optin.Models.Color_Palette_Collection=Backbone.Collection.extend({model:Optin.Models.Color_Palette});var Palettes=new Optin.Models.Color_Palette_Collection;_.each(optin_vars.palettes,function(e,t){e._id=t.replace(new RegExp(" ","g"),"_").toLowerCase(),e.label=t;var i=new Optin.Models.Color_Palette(e);Palettes.add(i)}),Optin.Models.Colors_Model=Hustle.get("Models.M").extend({defaults:_.extend({customize:!1,palette:Palettes.at(0).get("_id"),main_background:"",form_background:"",button_background:"",button_label:"",title_color:"",content_color:"",fields_background:"",fields_color:""},Palettes.at(0).toJSON())}),Optin.Models.Borders_Model=Backbone.Model.extend({defaults:{rounded_corners:!0,corners_radius:0,fields_corners_radius:0,button_corners_radius:0,drop_shadow:!1,dropshadow_value:0,shadow_color:"#000",fields_style:"joined",rounded_form_fields:!0,rounded_form_button:!0}}),Optin.Models.Design_Model=Hustle.get("Models.M").extend({defaults:{success_message:optin_vars.messages.model.defaults.success_message,form_location:"0",elements:["image"],image_location:"left",image_style:"cover",image_src:optin_vars.preview_image,colors:new Optin.Models.Colors_Model,borders:new Optin.Models.Borders_Model,opening_animation:"",closing_animation:"",css:"",on_submit:"success_message",on_submit_page_id:"",input_icons:"animated_icon",on_success:"remain",on_success_time:0,on_success_unit:"s",customize_css:!1,cta_button:optin_vars.messages.model.defaults.cta_button,module_fields:optin_vars.module_fields},initialize:function(e){_.extend(this,e),this.get("colors")instanceof Backbone.Model||this.set("colors",new Optin.Models.Colors_Model(this.colors)),this.get("borders")instanceof Backbone.Model||this.set("borders",new Optin.Models.Borders_Model(this.borders)),this.on("change",this.user_has_change,this)}});var old_conditions=["show_on_all_posts","excluded_posts","selected_posts","show_on_all_pages","excluded_pages","selected_pages","show_on_all_cats","show_on_these_cats","show_on_all_tags","show_on_these_tags"];Optin.Models.Settings_After_Content=Hustle.get("Models.M").extend({defaults:{enabled:!1,animate:!1,animation:""},initialize:function(e){if(!(this.get("conditions")instanceof Backbone.Model)){var t=Hustle.get("Model");_.isEmpty(this.get("conditions"))&&_.isArray(this.get("conditions"))?this.set("conditions",new t):this.set("conditions",new t(this.get("conditions")))}this.on("change",this.user_has_change,this)}}),Optin.Models.Settings_Popup_Model=Hustle.get("Model").extend({defaults:{enabled:!1,animation_in:"",animation_out:"",appear_after:"time",on_exit_trigger_once_per_session:!0,appear_after_scroll:"scrolled",appear_after_time_val:5,appear_after_time_unit:"seconds",appear_after_page_portion_val:20,appear_after_page_portion_unit:"%",appear_after_element_val:"",add_never_see_this_message:!1,close_button_acts_as_never_see_again:!1,never_see_expiry:2,show_on_all_posts:!0,excluded_posts:[],selected_posts:[],show_on_all_pages:!0,excluded_pages:[],selected_pages:[],show_on_all_cats:!0,show_on_these_cats:[],show_on_all_tags:!0,show_on_these_tags:[],conditions:{},trigger_on_time:"immediately",trigger_on_element_click:"",trigger_on_exit:!1,trigger_on_adblock:!1,trigger_on_adblock_timed:!1,trigger_on_adblock_timed_val:180,trigger_on_adblock_timed_unit:"seconds"},initialize:function(e){if(_.extend(this,e),!(this.get("conditions")instanceof Backbone.Model)){var t=Hustle.get("Model");_.isEmpty(this.get("conditions"))&&_.isArray(this.get("conditions"))?this.set("conditions",new t):this.set("conditions",new t(this.get("conditions")))}this.on("change",this.user_has_change,this)}}),Optin.Models.Settings_Slide_In_Model=Hustle.get("Model").extend({defaults:{enabled:!1,appear_after:"time",on_exit_trigger_once_per_session:!0,appear_after_scroll:"scrolled",appear_after_time_val:5,appear_after_time_unit:"seconds",appear_after_page_portion_val:30,appear_after_page_portion_unit:"%",appear_after_element_val:"",hide_after:!0,hide_after_val:10,hide_after_unit:"seconds",position:"bottom_right",after_close:"keep_showing",show_on_all_posts:!0,excluded_posts:[],selected_posts:[],show_on_all_pages:!0,excluded_pages:[],selected_pages:[],show_on_all_cats:!0,show_on_these_cats:[],show_on_all_tags:!0,show_on_these_tags:[],conditions:{},trigger_on_time:"immediately",trigger_on_element_click:"",trigger_on_exit:!1,trigger_on_adblock:!1,trigger_on_adblock_timed:!1,trigger_on_adblock_timed_val:180,trigger_on_adblock_timed_unit:"seconds"},initialize:function(e){if(!(this.get("conditions")instanceof Backbone.Model)){var t=Hustle.get("Model");_.isEmpty(this.get("conditions"))&&_.isArray(this.get("conditions"))?this.set("conditions",new t):this.set("conditions",new t(this.get("conditions")))}this.on("change",this.user_has_change,this)}}),Optin.Models.Settings_Model=Hustle.get("Models.M").extend({defaults:{shortcode_id:"",after_content:new Optin.Models.Settings_After_Content,popup:new Optin.Models.Settings_Popup_Model,slide_in:new Optin.Models.Settings_Slide_In_Model},initialize:function(e){_.extend(this,e),this.get("after_content")instanceof Backbone.Model||this.set("after_content",new Optin.Models.Settings_After_Content(this.get("after_content"))),this.get("popup")instanceof Backbone.Model||this.set("popup",new Optin.Models.Settings_Popup_Model(this.get("popup"))),this.get("slide_in")instanceof Backbone.Model||this.set("slide_in",new Optin.Models.Settings_Slide_In_Model(this.get("slide_in"))),this.on("change",this.user_has_change,this)}}),Hustle.define("Models.Trigger",function(){"use strict";return Hustle.get("Model").extend({defaults:{trigger:"time",on_time:"immediately",on_time_delay:5,on_time_unit:"seconds",on_scroll:"scrolled",on_scroll_page_percent:"20",on_scroll_css_selector:"",on_click_element:"",on_exit_intent:!0,on_exit_intent_per_session:!0,on_adblock:!1,on_adblock_delayed:!1,on_adblock_delayed_time:180,on_adblock_delayed_unit:"seconds"}})}),function(e){"use strict";Optin.get_tpl=function(e){var t=["optin-layout-one","optin-layout-two","optin-layout-three","optin-layout-four"];return Optin.template(t[e])},Optin.View.Alert=Backbone.View.extend({template:Optin.template("optin-alert-modal"),events:{"click .inc-opt-alert-modal-close":"close","click .inc-opt-alert-modal":"close","click .inc-opt-alert-modal-close-btn":"close","click .inc-opt-alert-modal-inner-container":"prevent_close"},initialize:function(e){return this.options=e,this.render()},render:function(){this.$el.html(this.template(_.extend({close_text:optin_vars.messages.ok},this.options))),this.$el.appendTo("body")},close:function(e){this.$el.hide(),this.remove()},prevent_close:function(e){e.preventDefault(),e.stopPropagation()}}),Optin.hasChanges=!1,Optin.user_change=function(){Optin.hasChanges=!0},window.onbeforeunload=function(){if(Optin.hasChanges)return optin_vars.messages.dont_navigate_away},Optin.step=Optin.step||{},Optin.step.activate_step=function(t){e(".wpoi-tabs-menu li").removeClass("active"),e(".wpoi-tabs-menu li").removeClass("before"),e(".wpoi-tabs-menu li").eq(t).addClass("active"),e(".wpoi-tabs-menu li").slice(0,t).addClass("before"),e(".wpoi-tabs-wrap > div").hide(),e(".wpoi-tabs-wrap > div").eq(t).show(),Optin.step.current=t},Optin.step.get_current_step=function(){return parseInt(Optin.step.current||0,10)},Optin.step.get_current=function(){return parseInt(Optin.step.current||0,10)},Optin.step.get_current_step=function(){switch(this.get_current){case 0:return Optin.step.services;case 1:return Optin.step.design;case 2:return Optin.step.display}}}(jQuery),Hustle.define("Custom_Content.After_Content_View",function(e,t,i){"use strict";return Hustle.View.extend(_.extend({},Hustle.get("Mixins.Model_Updater"),{template:Hustle.template("wpoi-custom-content-after-content-tpl"),message_editor:!1,events:{'change [name="animate"]':"toggle_animation"},init:function(e){return this.type=e.type,this.conditions_view=e.conditions_view,this.listenTo(this.model,"change:enabled",this.toggle_panel),this.conditions_view.on("toggle_condition",this.update_conditions_label),this.conditions_view.on("change:update_view_label",this.update_conditions_label),this.render()},render:function(){return this.$el.html(this.template(_.extend({},{type:this.type,type_name:optin_vars.messages.settings[this.type],condition_labels:this.conditions_view.get_all_conditions_labels()},this.model.toJSON()))),this.$(".wph-conditions").replaceWith(this.conditions_view.$el),_.isFalse(this.model.enabled)&&this.$el.find("#wph-after-content-condition-labels").hide(),this.toggle_animation(),this},toggle_panel:function(e){this.$(".switch-wrap").toggleClass("open closed"),this.$el.find("#wph-after-content-condition-labels").toggle()},update_conditions_label:function(t){e("#wph-after-content-condition-labels").html(t.get_all_conditions_labels())},toggle_animation:function(){var e=this.$('[name="animate"]:checked'),t="false"===e.val(),i=this.$("#optin-afterc-animation-block");i[t?"hide":"show"]()}}))}),Hustle.define("Custom_Content.Content_View",function(e,t,i){"use strict";return Hustle.View.extend(_.extend({},Hustle.get("Mixins.Model_Updater"),{template:Optin.template("wpoi-custom-content-content-tpl"),message_editor:!1,skip_tinyMCE_sync:!1,init:function(e){return this.design_model=e.design_model,this.sync_message(),this.listenTo(Hustle.Events,"CC.save_changes",this.sync_model_message),this.listenTo(Hustle.Events,"CC.opening_preview",this.sync_model_message),this.render()},render:function(e){this.setElement(this.template(_.extend({},this.model.toJSON(),this.design_model.toJSON())));var t=Hustle.get("Media_Holder");return this.media_holder=new t({model:this.design_model,attribute:"image"}),this.$(".wph-media--holder").html(this.media_holder.$el),this.listenTo(this.model,"change:optin_message",_.throttle(this.update_content,50)),this},sync_message:function(){var e=this,t=setInterval(function(){"object"==typeof tinyMCE&&(clearInterval(t),tinyMCE.on("AddEditor",function(t){e.message_editor=tinyMCE.get("optin_message"),e.message_editor.on("change",function(t){e.model.set("optin_message",e.message_editor.getContent())})}))})},sync_model_message:function(){this.skip_tinyMCE_sync||"object"==typeof tinyMCE&&(this.message_editor||(this.message_editor=tinyMCE.get("optin_message")),this.model.set("optin_message",this.message_editor.getContent()))},update_content:function(){var t=this;e.ajax({url:ajaxurl,type:"get",data:{action:"hustle_CC_parse_content",html:t.model.get("optin_message")},success:function(e){e.success&&t.model.set("content",e.data)}})}}))}),Hustle.define("Custom_Content.Design_View",function(e,t,i){"use strict";return Hustle.View.extend(_.extend({},Hustle.get("Mixins.Model_Updater"),{template:Optin.template("wpoi-custom-content-design-tpl"),media_frame:!1,css_editor:!1,stylables:{".wph-modal.wph-modal-container .wph-modal--content ":"Container",".wph-modal.wph-modal-container.wph-customize-css h2.wph-modal--title ":"Title",".wph-modal.wph-modal-container.wph-customize-css .wph-modal--content h4.wph-modal--subtitle ":"Subtitle",".wph-modal .wph-modal--content .wph-modal--message ":"Content",".wph-modal .wph-modal--content .wph-modal--image ":"Image Container",".wph-modal.wph-modal-container.wph-customize-css .wph-modal--content .wph-modal--image img ":"Image",".wph-modal .wph-modal--cta ":"CTA Button",".wph-modal .wph-modal-never-see-again ":"Never See Again"},stylable_elements:_({main_bg_color:".wph-modal.wph-modal--cabriolet section, .wph-modal.wph-modal--simple .wph-modal--content, .wph-modal.wph-modal--minimal .wph-modal--content",title_color:".wph-modal.wph-modal--cabriolet .wph-modal--content h2.wph-modal--title, .wph-modal.wph-modal--simple .wph-modal--content header h2.wph-modal--title, .wph-modal.wph-modal--minimal .wph-modal--content h2.wph-modal--title",subtitle_color:".wph-modal.wph-modal--cabriolet .wph-modal--content h4.wph-modal--subtitle, .wph-modal.wph-modal--simple .wph-modal--content header h4.wph-modal--subtitle, .wph-modal.wph-modal--minimal .wph-modal--content header h4.wph-modal--subtitle",link_static_color:".wph-modal .wph-modal--message a, .wph-modal.wph-modal--cabriolet .wph-modal--content .wph-modal--message a:not(.wph-modal--cta), .wph-modal.wph-modal--simple .wph-modal--content .wph-modal--message a:not(.wph-modal--cta), .wph-modal.wph-modal--minimal .wph-modal--content .wph-modal--message a:not(.wph-modal--cta)",link_hover_color:".wph-modal .wph-modal--message a:hover, .wph-modal.wph-modal--cabriolet section .wph-modal--message a:not(.wph-modal--cta):hover, .wph-modal.wph-modal--simple .wph-modal--content .wph-modal--message a:not(.wph-modal--cta):hover, .wph-modal.wph-modal--minimal .wph-modal--content a:not(.wph-modal--cta):hover",link_active_color:".wph-modal .wph-modal--message a:active, .wph-modal.wph-modal--cabriolet section .wph-modal--message a:not(.wph-modal--cta):active, .wph-modal.wph-modal--simple .wph-modal--content .wph-modal--message a:not(.wph-modal--cta):active, .wph-modal.wph-modal--minimal .wph-modal--content a:not(.wph-modal--cta):active",cta_static_background:".wph-modal .wph-modal--cta, .wph-modal .wph-modal--message a.wph-modal--cta",cta_hover_background:".wph-modal .wph-modal--cta:hover, .wph-modal .wph-modal--message a.wph-modal--cta:hover",cta_active_background:".wph-modal .wph-modal--cta:active, .wph-modal .wph-modal--message a.wph-modal--cta:active",cta_static_color:".wph-modal .wph-modal--cta, .wph-modal .wph-modal--message a.wph-modal--cta",cta_hover_color:".wph-modal .wph-modal--cta:hover, .wph-modal .wph-modal--message a.wph-modal--cta:hover",cta_active_color:".wph-modal .wph-modal--cta:active, .wph-modal .wph-modal--message a.wph-modal--cta:active",border_static_color:".wph-modal.wph-modal--cabriolet section, .wph-modal.wph-modal--simple .wph-modal--content, .wph-modal.wph-modal--minimal .wph-modal--content",border_radius:".wph-modal.wph-modal--cabriolet section, .wph-modal.wph-modal--simple .wph-modal--content, .wph-modal.wph-modal--minimal .wph-modal--content",border_weight:".wph-modal.wph-modal--cabriolet section, .wph-modal.wph-modal--simple .wph-modal--content, .wph-modal.wph-modal--minimal .wph-modal--content",border_type:".wph-modal.wph-modal--cabriolet section, .wph-modal.wph-modal--simple .wph-modal--content, .wph-modal.wph-modal--minimal .wph-modal--content",drop_shadow_color:".wph-modal.wph-modal--cabriolet section, .wph-modal.wph-modal--simple .wph-modal--content, .wph-modal.wph-modal--minimal .wph-modal--content",drop_shadow_x:".wph-modal.wph-modal--cabriolet section, .wph-modal.wph-modal--simple .wph-modal--content, .wph-modal.wph-modal--minimal .wph-modal--content",drop_shadow_y:".wph-modal.wph-modal--cabriolet section, .wph-modal.wph-modal--simple .wph-modal--content, .wph-modal.wph-modal--minimal .wph-modal--content",drop_shadow_blur:".wph-modal.wph-modal--cabriolet section, .wph-modal.wph-modal--simple .wph-modal--content, .wph-modal.wph-modal--minimal .wph-modal--content",drop_shadow_spread:".wph-modal.wph-modal--cabriolet section, .wph-modal.wph-modal--simple .wph-modal--content, .wph-modal.wph-modal--minimal .wph-modal--content",custom_height:".wph-modal.wph-modal--popup, .wph-modal.wph-modal--popup .wph-modal--content",custom_width:".wph-modal.wph-modal--popup, .wph-modal.wph-modal--popup .wph-modal--content"}),events:{"click .wph-stylable-element":"insert_stylable_element"},init:function(){return this.on("rendered",this.create_color_pickers),this.listenTo(this.model,"change:customize_colors",this.render),this.listenTo(this.model,"change:customize_css",this.render),this.listenTo(this.model,"change:customize_size",this.render),this.listenTo(this.model,"change:border",this.render),this.listenTo(this.model,"change:drop_shadow",this.render),
this.listenTo(this.model,"change:style",this.render),this.listenTo(this.model,"change",this.apply_styles),this.render()},render:function(){return this.$el.html(this.template(_.extend({},this.model.toJSON(),{stylables:this.stylables}))),this.apply_styles(),this.create_css_editor(),this},create_color_pickers:function(){this.$(".wph-color-picker").wpColorPicker({change:function(t,i){var s=e(this);s.val(i.color.toCSS()).trigger("change")}})},get_layout_colors:function(){return!!_.isTrue(this.model.get("customize_colors"))&&_(this.model.toJSON()).reduce(function(e,t,i){return _.indexOf(["drop_shadow_color"],i)!==-1||/^border_/.test(i)||/^drop_/.test(i)?e:((/_background$/.test(i)||/_color$/.test(i)||/_background_color$/.test(i))&&(e[i]=t),e)},{})},apply_styles:_.debounce(function(){var t=this,i=this.model.toJSON(),s=this.get_layout_colors(),n="",o=e("#hustle-css-preview-styles").length?e("#hustle-css-preview-styles"):e('<style id="hustle-css-preview-styles">').appendTo("body");if(_.isEmpty(s)||_.each(s,function(e,i){var s=/_background$/.test(i)||/_background_color$/.test(i)||/_bg_color/.test(i)?"background":"color",o=t.stylable_elements.result(i);o&&(n+=o+"{ "+s+": "+e+";} ")}),_.isTrue(i.border)){var a=Hustle.create_template(" {{el}} {border:{{weight}}px {{type}} {{color}}; }"),l=Hustle.create_template(" {{el}} {border-radius:{{radius}}px; }");_(["border_static_color"]).each(function(e,t){n+=a({el:this.stylable_elements.result(e),weight:i.border_weight,type:i.border_type,color:i[e]})}.bind(this)),n+=l({el:this.stylable_elements.result("border_radius"),radius:i.border_radius})}if(_.isTrue(i.drop_shadow)){var r=Hustle.create_template(" {{el}} {box-shadow:{{x}}px {{y}}px {{blur}}px {{spread}}px {{color}}; }");n+=r({el:this.stylable_elements.result("drop_shadow_color"),x:i.drop_shadow_x,y:i.drop_shadow_y,blur:i.drop_shadow_blur,spread:i.drop_shadow_spread,color:i.drop_shadow_color})}_.isTrue(i.customize_css)&&(n+=i.custom_css),o.html(n)},10),create_css_editor:_.debounce(function(){_.isFalse(this.model.get("customize_css"))||(this.css_editor=ace.edit("hustle_custom_css"),this.css_editor.getSession().setMode("ace/mode/css"),this.css_editor.setTheme("ace/theme/solarized_light"),this.css_editor.getSession().setUseWrapMode(!0),this.css_editor.getSession().setUseWorker(!1),this.css_editor.setShowPrintMargin(!1),this.css_editor.renderer.setShowGutter(!0),this.css_editor.setHighlightActiveLine(!0),this.css_editor.on("blur",e.proxy(this.update_custom_css,this)))},0),update_custom_css:function(){this.css_editor&&this.model.set("custom_css",this.css_editor.getValue())},insert_stylable_element:function(t){t.preventDefault();var i=e(t.target),s=i.data("stylable")+"{}";this.css_editor.navigateFileEnd(),this.css_editor.insert(s),this.css_editor.navigateLeft(1),this.css_editor.focus()}}))}),Hustle.define("Custom_Content.Listing",function(e,t,i){"use strict";var s=Hustle.get("Delete_Confirmation");return Backbone.View.extend({el:"#wph-ccontent--modules",events:{"click .wph-accordions header":"toggle_accordion","change .custom-content-toggle-activity":"toggle_activity","change .custom-content-toggle-tracking-activity":"toggle_tracking_activity","change .custom-content-toggle-type-activity":"toggle_type_activity","change .custom-content-toggle-test-activity":"toggle_test_activity","click .custom-content-edit":"edit","click .custom-content-delete":"delete"},delete_confirmations:{},initialize:function(){e(t).on("click","#hustle-legacy-popup-notice button.notice-dismiss",this.dismiss_legacy_popup_notice)},dismiss_legacy_popup_notice:function(t){var i=e(t.target).closest("#hustle-legacy-popup-notice"),s=i.data("nonce");e.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_custom_content_dismiss_legacy_notice",_ajax_nonce:s}})},toggle_accordion:function(t){if(_.indexOf(["wph-accordion--animate_buttons","wph-icon i-arrow"],t.target.className)!==-1){var i=e(t.target),s=i.find(".dev-icon"),n=i.closest("li");n.find("section");s.toggleClass("dev-icon-caret_down dev-icon-caret_up"),n.toggleClass("wph-accordion--closed wph-accordion--open"),n.siblings("li.wph-accordion--open").toggleClass("wph-accordion--closed wph-accordion--open")}},toggle_activity:function(t){t.stopPropagation();var i=e(t.target),s=i.data("id"),n=i.data("nonce"),o=i.is(":checked");i.attr("disabled",!0),e.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_custom_content_toggle_activity",id:s,_ajax_nonce:n},complete:function(){i.attr("disabled",!1)},success:function(e){e.success||i.attr("checked",!o)},error:function(){i.attr("checked",!o)}})},toggle_tracking_activity:function(t){t.stopPropagation();var i=e(t.target),s=i.data("id"),n=i.data("nonce"),o=i.data("type"),a=i.is(":checked");i.attr("disabled",!0),e.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_custom_content_toggle_tracking_activity",id:s,type:o,_ajax_nonce:n},complete:function(){i.attr("disabled",!1)},success:function(e){e.success||i.attr("checked",!a)},error:function(e){e.success||i.attr("checked",!a)}})},toggle_type_activity:function(t){t.stopPropagation();var i=e(t.target),s=i.data("id"),n=i.data("nonce"),o=i.data("type"),a=i.is(":checked");i.attr("disabled",!0),e.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_custom_content_toggle_type_activity",id:s,type:o,_ajax_nonce:n},complete:function(){i.attr("disabled",!1)},success:function(e){e.success||i.attr("checked",!a)},error:function(e){e.success||i.attr("checked",!a)}})},toggle_test_activity:function(t){t.stopPropagation();var i=e(t.target),s=i.data("id"),n=i.data("nonce"),o=i.data("type"),a=i.is(":checked");i.attr("disabled",!0),e.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_custom_content_toggle_test_activity",id:s,type:o,_ajax_nonce:n},complete:function(){i.attr("disabled",!1)},success:function(e){e.success||i.attr("checked",!a)},error:function(e){e.success||i.attr("checked",!a)}})},edit:function(e){e.stopPropagation()},"delete":function(e){e.stopPropagation();var t=this.$(e.target);if(!t.prev(".hustle-delete-module-confirmation").length){var i=t.closest("li.wph-accordions--item"),n=(t.data("id"),new s({id:t.data("id"),nonce:t.data("nonce"),action:"hustle_custom_content_delete",onSuccess:function(e){e.success&&(n.remove(),i.toggle("highlight"))}}));t.before(n.$el)}}})}),Hustle.define("Custom_Content.Models",function(){"use strict";var e=Hustle.get("Models.M").extend({defaults:{optin_name:"",optin_title:"",subtitle:"",optin_message:"Type your content here ...",content:"",optin_provider:"custom_content",api_key:"",mail_list:"",active:1,test_mode:0}}),t=Hustle.get("Models.M").extend({defaults:{style:"cabriolet",customize_colors:0,customize_css:0,custom_css:"",main_bg_color:"rgba(255,255,255,1)",title_color:"rgba(51,51,51,1)",subtitle_color:"rgba(51,51,51,1)",link_static_color:"#1FC5B6",link_hover_color:"#15A296",link_active_color:"#15A296",cta_static_background:"#1FC5B6",cta_hover_background:"#15A296",cta_active_background:"#15A296",cta_static_color:"rgba(255,255,255,1)",cta_hover_color:"rgba(255,255,255,1)",cta_active_color:"rgba(255,255,255,1)",border:!0,border_radius:5,border_weight:3,border_type:"solid",border_static_color:"rgba(218,218,218,1)",border_hover_color:"rgba(218,218,218,1)",border_active_color:"rgba(218,218,218,1)",drop_shadow:!1,drop_shadow_x:0,drop_shadow_y:0,drop_shadow_blur:0,drop_shadow_spread:0,drop_shadow_color:"rgba(0,0,0,0)",image:"",hide_image_on_mobile:!1,image_position:"left",cta_label:"",cta_url:"",cta_target:"_blank",customize_size:!1,custom_height:300,custom_width:600}}),i=Hustle.get("Models.Trigger"),s=Hustle.get("Models.M").extend({defaults:{enabled:!1,conditions:"",triggers:"",animation_in:"",animation_out:"",make_fullscreen:!1,add_never_see_link:!1,close_btn_as_never_see:!1,allow_scroll_page:!1,not_close_on_background_click:!1,expiration_days:365,on_submit:"default"},initialize:function(e){if(_.extend(this,e),this.get("triggers")instanceof Backbone.Model||this.set("triggers",new i(this.triggers)),!(this.get("conditions")instanceof Backbone.Model)){_.isEmpty(this.get("conditions"))&&_.isArray(this.get("conditions"))&&(this.conditions={});var t=Hustle.get("Model");this.set("conditions",new t(this.conditions))}this.on("change",this.user_has_change,this)}}),n=s.extend({defaults:{enabled:!1,animate:!1,animation:"",on_submit:""}}),o=s.extend(),a=s.extend({defaults:{enabled:!1,conditions:"",triggers:"",animation_in:"",animation_out:"",make_fullscreen:!1,add_never_see_link:!1,close_btn_as_never_see:!1,expiration_days:0,on_submit:"refresh_or_close",hide_after:!0,hide_after_val:10,hide_after_unit:"seconds",position:"bottom_right",after_close:"keep_showing"}}),l=s.extend();return{Content:e,Design:t,TypeBase:s,AfterContent:n,Popup:o,Slide_In:a,Magic_Bar:l}}),Hustle.define("Custom_Content.Popup_View",function(e,t,i){"use strict";return Hustle.View.extend(_.extend({},Hustle.get("Mixins.Model_Updater"),{template:Hustle.template("wpoi-custom-content-popup-tpl"),message_editor:!1,init:function(e){return this.type=e.type,this.display_triggers_view=e.display_triggers_view,this.conditions_view=e.conditions_view,this.listenTo(this.model,"change:enabled",this.toggle_panel),this.conditions_view.on("toggle_condition",this.update_conditions_label),this.conditions_view.on("change:update_view_label",this.update_conditions_label),this.render()},render:function(){return this.$el.html(this.template(_.extend({},{type:this.type,type_name:optin_vars.messages.settings[this.type],condition_labels:this.conditions_view.get_all_conditions_labels()},this.model.toJSON()))),this.$(".wph-trigger").html(this.display_triggers_view.$el),this.$(".wph-conditions").replaceWith(this.conditions_view.$el),_.isFalse(this.model.enabled)&&this.$el.find("#wph-popup-condition-labels").hide(),this},toggle_panel:function(e){this.$(".switch-wrap").toggleClass("open closed"),this.$el.find("#wph-popup-condition-labels").toggle()},update_conditions_label:function(t){e("#wph-popup-condition-labels").html(t.get_all_conditions_labels())}}))}),Hustle.define("Custom_Content.Preview",function(e){"use strict";return Backbone.View.extend({el:".wph-preview",preview_modal:!1,$preview_yield:!1,events:{"click .wph-preview--mask":"hide","click .wph-preview--close":"hide","change #wph-preview-type-selector":"change_type"},initialize:function(){this.$preview_yield=this.$("#wph-preview-yield"),this.render(),this.listenTo(this.preview_modal.model,"all",this.render)},render:function(){var e=Hustle.get("Modal");this.preview_modal=new e({model:this.model}),this.$preview_yield.replaceWith(this.preview_modal.$el),this.$preview_yield=this.preview_modal.$el,this.preview_modal.show(),this.$("#wph-preview-type-selector").val(this.model.get("type")),Hustle.Events.trigger("view.rendered",this)},show:function(){this.$el.removeClass("wph-preview--closed").addClass("wph-preview--open")},hide:function(e){this.$el.removeClass("wph-preview--open").addClass("wph-preview--closed")},change_type:function(e){this.preview_modal.model.set("type",this.$(e.target).val()),Hustle.Events.trigger("cc.type_changed",this)}})}),Hustle.define("Custom_Content.Slide_In_View",function(e,t,i){"use strict";return Hustle.View.extend(_.extend({},Hustle.get("Mixins.Model_Updater"),{template:Hustle.template("wpoi-custom-content-slide_in-tpl"),message_editor:!1,init:function(e){return this.type=e.type,this.display_triggers_view=e.display_triggers_view,this.conditions_view=e.conditions_view,this.listenTo(this.model,"change:enabled",this.toggle_panel),this.listenTo(this.model,"change:position",this.update_slide_in_position_label),this.conditions_view.on("toggle_condition",this.update_conditions_label),this.conditions_view.on("change:update_view_label",this.update_conditions_label),this.render()},render:function(){return this.model.set("position_label",optin_vars.messages.positions[this.model.get("position")],{silent:!0}),this.$el.html(this.template(_.extend({},{type:this.type,type_name:optin_vars.messages.settings[this.type],condition_labels:this.conditions_view.get_all_conditions_labels()},this.model.toJSON()))),this.$(".wph-trigger").html(this.display_triggers_view.$el),this.$(".wph-conditions").replaceWith(this.conditions_view.$el),_.isFalse(this.model.enabled)&&this.$el.find("#wph-slide-in-condition-labels").hide(),this},toggle_panel:function(e){this.$(".switch-wrap").toggleClass("open closed"),this.$el.find("#wph-slide-in-condition-labels").toggle()},update_slide_in_position_label:function(e){this.$("#wpoi-slide_in-position-label").text(optin_vars.messages.positions[this.model.get("position")])},update_conditions_label:function(t){e("#wph-slide-in-condition-labels").html(t.get_all_conditions_labels())}}))}),Hustle.define("Custom_Content.View",function(e,t,i){"use strict";return Hustle.View.extend({el:".wph-custom-content",message_box_tpl:Optin.template("wpoi-custom-content-message-box-tp"),preview:!1,preview_model:!1,initial_data:new Backbone.Model({content:"",design:"",popup:"",slide_in:"",magic_bar:""}),events:{"click .wph-toggletabs .can-open":"toggle_accordion","click #save-and-next":"save_and_next","click #next-step":"save_and_next","click #save-and-finish":"save_and_finish","click #finish-setup":"save_and_finish","click .wph-preview--eye.wph-button":"open_preview","click .wph-js-cancel-design-changes":"cancel_changes","click .wph-js-back":"go_back","click .wph-triggers--options label":"handle_triggers","click button#optin_message-tmce":"tinyMCE_toggled","change textarea#optin_message":"text_area_update","keyup [data-attribute='optin_name']":"remove_error"},init:function(e){return this.content_view=e.content_view,this.design_view=e.design_view,this.after_content_view=e.after_content_view,this.popup_view=e.popup_view,this.slide_in=e.slide_in,this.magic_bar=e.magic_bar,this.update_initial_state(),this.listenTo(this.model,"change",this.render_message_box),this.listenTo(this.content_view.model,"change",this.enable_cancel),this.listenTo(this.content_view.model,"change:content",this._set_preview_model),this.listenTo(Hustle.Events,"cc.type_changed",this.apply_proper_preview_styles),this.listenTo(this.design_view.model,"change",this.enable_cancel),this.render_message_box(),this.render()},tinyMCE_toggled:function(e){this.content_view.skip_tinyMCE_sync=!1},text_area_update:function(t){this.content_view.model.set("optin_message",e(t.target).val()),this.content_view.model.set("content",e(t.target).val()),this.content_view.skip_tinyMCE_sync=!0},handle_triggers:function(t){var i=e(t.target),s=i.closest("li"),n=s.siblings();n.removeClass("current"),s.addClass("current")},update_initial_state:function(){_.extend(this.initial_data,{content:this.content_view.model.toJSON(),design:this.design_view.model.toJSON(),popup:this.popup_view.model.toJSON(),slide_in:this.slide_in.model.toJSON(),magic_bar:this.magic_bar.model.toJSON()})},enable_cancel:_.throttle(function(){},50),render:function(){e(t).on("click","#hustle-legacy-popup-notice button.notice-dismiss",this.dismiss_legacy_popup_notice),this.content_view.delegateEvents(),this.design_view.delegateEvents(),this.$("#wph-ccontent--designtab .wph-toggletabs--content").append(this.content_view.$el).append(this.design_view.$el);var i=this.$("#wph-ccontent-after-content-container").attr("class");this.$("#wph-ccontent-after-content-container").replaceWith(this.after_content_view.$el.addClass(i).attr("id","wph-ccontent-after-content-container"));var s=this.$("#wph-ccontent-popup-container").attr("class");this.$("#wph-ccontent-popup-container").replaceWith(this.popup_view.$el.addClass(s).attr("id","wph-ccontent-popup-container"));var n=this.$("#wph-ccontent-slide_in-container").attr("class");this.$("#wph-ccontent-slide_in-container").replaceWith(this.slide_in.$el.addClass(n).attr("id","wph-ccontent-slide_in-container"));var o=this.$("#wph-ccontent-magic_bar-container").attr("class");this.$("#wph-ccontent-magic_bar-container").replaceWith(this.magic_bar.$el.addClass(o).attr("id","wph-ccontent-magic_bar-container"))},render_message_box:function(){var e=this._get_shortcode_id();this.$("#wph-ccontent--messagebox").html(this.message_box_tpl({shortcode_id:e}))},toggle_accordion:function(t){t.preventDefault();var i=e(t.target),s=e(".wph-toggletabs"),n=i.closest(".wph-toggletabs"),o=s.not(n),a=n.find(".dev-icon-caret_down, .dev-icon-caret_up");o.removeClass("wph-toggletabs--open"),o.find(".dev-icon-caret_up").removeClass("dev-icon-caret_up").addClass("dev-icon-caret_down"),n.toggleClass("wph-toggletabs--open wph-toggletabs--closed"),a.toggleClass("dev-icon-caret_down dev-icon-caret_up")},_get_shortcode_id:function(){return this.model.get("optin_name").trim().toLowerCase().replace(/\s+/g,"-")},dismiss_legacy_popup_notice:function(t){var i=e(t.target).closest("#hustle-legacy-popup-notice"),s=i.data("nonce");e.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_custom_content_dismiss_legacy_notice",_ajax_nonce:s}})},_save:function(t){var i=(t.next().hasClass("wph-button-finish")?t.outerWidth()+1:t.outerWidth(),t.data("id"));return e.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_custom_content_save",_ajax_nonce:t.data("nonce"),id:t.data("id"),content:this.content_view.model.toJSON(),design:this.design_view.model.toJSON(),after_content:this.after_content_view.model.toJSON(),popup:this.popup_view.model.toJSON(),slide_in:this.slide_in.model.toJSON(),magic_bar:this.magic_bar.model.toJSON(),shortcode_id:this._get_shortcode_id()},complete:function(e){if(t.attr("disabled",!1).removeClass("wph-button-next--loading").removeClass("wph-button-save--loading"),Optin.hasChanges=!1,i==-1){var s=window.location.pathname+window.location.search;s=s.replace("id=-1","id="+e.responseJSON.data),window.history.replaceState({},"",s)}}})},save_and_next:function(t){if(t.preventDefault(),Hustle.Events.trigger("CC.save_changes"),this.validate()){var i=this,s=this.$(t.target).closest("button");s.attr("disabled",!0),s.is("#save-and-next")?s.addClass("wph-button-save--loading"):s.addClass("wph-button-next--loading"),s.siblings().each(function(){e(this).attr("disabled",!0)}),this._save(s).done(function(n){n.success&&(i.$("#next-step").data("id",n.data),i.$("#save-and-next").data("id",n.data),i.$("#save-and-finish").data("id",n.data),i.$("#finish-setup").data("id",n.data),i.update_initial_state(),s.is("#next-step")&&i.next_step(t),_.delay(function(){s.siblings().each(function(){e(this).attr("disabled",!1)})},300)),Optin.hasChanges=!1})}},next_step:function(e){e.preventDefault(),this.$("#wph-ccontent--settingstab .wph-toggletabs--title.can-open span").click()},save_and_finish:function(t){if(Hustle.Events.trigger("CC.save_changes"),t.preventDefault(),this.validate()){var i=this,s=this.$(t.target).closest("button");parseInt(s.data("id"))==-1;s.attr("disabled",!0),s.is("#save-and-finish")?s.addClass("wph-button-save--loading"):s.addClass("wph-button-next--loading"),s.siblings().each(function(){e(this).attr("disabled",!0)}),this._save(s).done(function(t){t.success&&(i.$("#next-step").data("id",t.data),i.$("#save-and-next").data("id",t.data),i.$("#save-and-finish").data("id",t.data),i.$("#finish-setup").data("id",t.data),s.is("#finish-setup")&&i.finish_setup(s),_.delay(function(){s.siblings().each(function(){e(this).attr("disabled",!1)})},300)),Optin.hasChanges=!1})}},finish_setup:function(e){var t=parseInt(e.data("id"))==-1;window.onbeforeunload=null;var i="?page=inc_hustle_custom_content";i+=t?"&new_id="+e.data("id"):"&updated_id="+e.data("id"),window.location.replace(i)},remove_error:function(){this.$(".dashicons-warning").remove()},validate:function(){var t,i=!0,s=(this.design_view.model.get("cta_url"),this.$('[data-attribute="optin_name"]'));return s.val()||(t=e('<span class="dashicons dashicons-warning">').attr("title",optin_vars.messages.custom_content.no_name),s.after(t),i=!1),i&&e("span.dashicons.dashicons-warning").remove(),i},_set_preview_model:function(){return this.preview_model?void this.preview_model.set(_.extend({},{type:"popup"},this.design_view.model.toJSON(),this.content_view.model.toJSON(),{optin_message:this.content_view.model.get("content")},{types:{popup:this.popup_view.model.toJSON(),slide_in:this.slide_in.model.toJSON(),after_content:this.after_content_view.model.toJSON()}})):void(this.preview_model=new Backbone.Model(_.extend({},{id:this.content_view.model.get("optin_id"),type:"popup"},this.design_view.model.toJSON(),this.content_view.model.toJSON(),{optin_message:this.content_view.model.get("content")},{types:{popup:this.popup_view.model.toJSON(),slide_in:this.slide_in.model.toJSON(),after_content:this.after_content_view.model.toJSON()}})))},open_preview:function(e){if(Hustle.Events.trigger("CC.opening_preview"),this.validate()){if(this._set_preview_model(),this.preview)this.preview.render(),this.preview.show();else{var t=Hustle.get("Custom_Content.Preview");this.preview=new t({model:this.preview_model}),this.preview.show()}this.apply_custom_css();var i=this;setTimeout(function(){i.apply_proper_preview_styles()},500)}},cancel_changes:function(e){window.onbeforeunload=null,window.location.replace("?page=inc_hustle_custom_content")},go_back:function(e){this.$("#wph-ccontent--designtab .wph-toggletabs--title.can-open span").click()},apply_proper_preview_styles:function(){var t=this;e(".wph-modal").each(function(){var i=e(this),s=i.find(".wph-modal--content"),n=i.find(".wph-modal--content > section"),o=s.find("section > figure"),a=i.find(".wph-modal--content > figure"),l=o.find("img"),r=a.find("img"),c=i.hasClass("wph-modal--cabriolet")&&(o.hasClass("wph-modal--image_full")||o.hasClass("wph-modal--image")&&l.height()<o.height()),d=i.hasClass("wph-modal--simple")&&(a.hasClass("wph-modal--image_full")||a.hasClass("wph-modal--image")&&r.height()<a.height()),p=i.hasClass("wph-modal--minimal")&&(o.hasClass("wph-modal--image_full")||o.hasClass("wph-modal--image")&&l.height()<o.height());(c||p)&&l.css({height:n.height()+"px",width:n.width()+"px"}),d&&r.css({height:s.height()+"px",width:s.width()+"px"});var h=t.design_view.model.toJSON(),u=i.find(".wph-modal--content header"),g=i.find(".wph-modal--content footer"),m=i.find(".wph-modal--content"),w=i.find(".wph-modal--content .wph-modal--message"),v=i.find(".wph-modal--content section"),f=i.find(".wph-modal--content .wph-modal--image"),b=i.find(".wph-modal--content .wph-modal--image img"),y=parseInt(h.custom_width),x=parseInt(h.custom_height),k=_.isTrue(h.border)?2*parseInt(h.border_weight):0;_.isTrue(h.customize_size)&&(i.css("width",y+"px"),i.css("max-width","none"),i.hasClass("wph-modal--cabriolet")&&(w.outerHeight(x-u.outerHeight(!0)-k),f.outerHeight(w.outerHeight(!0)),b.outerHeight(w.outerHeight(!0))),i.hasClass("wph-modal--simple")&&(m.outerHeight(x),f.outerHeight(m.height()),b.outerHeight(m.height())),i.hasClass("wph-modal--minimal")&&(v.outerHeight(x-(u.outerHeight(!0)+g.outerHeight(!0))-k),f.outerHeight(v.outerHeight(!0)),b.outerHeight(v.outerHeight(!0))))})},apply_custom_css:function(){if(this.design_view.css_editor){var t=e("#hustle-cc-custom-styles").length?e("#hustle-cc-custom-styles"):e('<style id="hustle-cc-custom-styles">').appendTo("body"),i=this.design_view.css_editor.getValue();e.ajax({type:"POST",url:ajaxurl,dataType:"json",data:{action:"hustle_CC_prepare_custom_css",css:i,_ajax_nonce:e("#hustle_custom_css").data("nonce")},success:function(e){e&&e.success&&t.html(e.data)},error:function(){}})}}})}),Hustle.define("Social_Sharing.Appearance_View",function(e,t,i){"use strict";return Hustle.View.extend(_.extend({},Hustle.get("Mixins.Model_Updater"),{template:Optin.template("wpoi-social-sharing-appreance-tpl"),init:function(e){return this.on("rendered",this.create_color_pickers),this.listenTo(Hustle.Events,"SS.appearance_view_ready",this.ready),this.render()},render:function(e){return this.service_model_json=window.services_model.toJSON(),this._handle_icons_order(),this.setElement(this.template(_.extend({},this.model.toJSON(),this.service_model_json))),this},create_color_pickers:function(){this.$(".wph-color-picker").wpColorPicker({change:function(t,i){var s=e(this);s.val(i.color.toCSS()).trigger("change")}})},ready:function(){var t=this.service_model_json.social_icons,i=this.$(".wph-sshare-reorder_box"),s=this.model.get("icon_style"),n=this.$(".wph-sshare-floating-social--preview_box"),o=n.find(".wph-sshare--container"),a=this.$(".wph-sshare-widget--preview_box"),l=a.find(".wph-sshare--container");_.each(t,e.proxy(function(e,t){var n="one"==s?Optin.template("wpoi-sshare-"+t+"-one-svg"):Optin.template("wpoi-sshare-"+t+"-svg"),a=n(),r='<div class="wph-sshare-reorder_item" data-id="'+t+'">'+a+"</div>";i.append(r);var c=a,d="";"native"==this.service_model_json.service_type&&(_.isTrue(this.service_model_json.click_counter)&&(c+='<div class="wph-sshare_social_counter"><span>'+e.counter+"</span></div>"),d="native-social-share");var p='<a data-social="'+t+'" href="#" class="'+d+'" target="_blank">'+c+"</a>";o.append(p);var h='<a data-social="'+t+'" href="#" class="'+d+'" target="_blank">'+c+"</a>";l.append(h)},this)),this.make_icons_sortable(),"native"==this.service_model_json.service_type&&("1"==this.model.get("floating_inline_count")?o.addClass("wph-sshare--count_inline"):o.addClass("wph-sshare--count_block"),"1"==this.model.get("widget_inline_count")?l.addClass("wph-sshare--count_inline"):l.addClass("wph-sshare--count_block"))},make_icons_sortable:function(){var e=this,t={items:".wph-sshare-reorder_item",revert:!0,axis:"x",containment:this.$("#wph-sshare-icons_reorder"),stop:function(t,i){e._reorder_icons()}};this.$(".wph-sshare-reorder_box").sortable(t).disableSelection()},_handle_icons_order:function(){var e={},t=this.service_model_json.social_icons,i=this.model.get("icons_order"),s=i.split(",");i&&s.length&&(_.each(s,function(i,s){"undefined"!=typeof t[i]&&(e[i]=t[i],t=_.pick(t,function(e,t){if(i!==t)return t=e}))}),Object.keys(t).length&&(e=_.extend(e,_.pick(t,function(e,t){if("undefined"!=typeof e)return t=e}))),this.service_model_json.social_icons=e)},_reorder_icons:function(){var t=[];this.$(".wph-sshare-reorder_box").find(".wph-sshare-reorder_item").each(function(){t.push(e(this).data("id"))}),this.model.set("icons_order",t.join())}}))}),Hustle.define("Social_Sharing.Floating_View",function(e,t,i){"use strict";return Hustle.View.extend(_.extend({},Hustle.get("Mixins.Model_Updater"),{template:Hustle.template("wpoi-social-sharing-floating-tpl"),message_editor:!1,events:{'change [name="animate"]':"toggle_animation"},init:function(e){return this.type=e.type,this.conditions_view=e.conditions_view,this.listenTo(this.model,"change:enabled",this.toggle_panel),this.conditions_view.on("toggle_condition",this.update_conditions_label),this.conditions_view.on("change:update_view_label",this.update_conditions_label),this.render()},render:function(){return this.$el.html(this.template(_.extend({},{type:this.type,type_name:optin_vars.messages.settings[this.type],condition_labels:this.conditions_view.get_all_conditions_labels()},this.model.toJSON()))),this.$(".wph-conditions").replaceWith(this.conditions_view.$el),_.isFalse(this.model.enabled)&&this.$el.find("#wph-floating-social-condition-labels").hide(),this.toggle_animation(),this},toggle_panel:function(e){this.$(".switch-wrap").toggleClass("open closed"),this.$el.find("#wph-floating-social-condition-labels").toggle()},update_conditions_label:function(t){e("#wph-floating-social-condition-labels").html(t.get_all_conditions_labels())},toggle_animation:function(){var e=this.$('[name="animate"]:checked'),t="false"===e.val(),i=this.$("#optin-afterc-animation-block");i[t?"hide":"show"]()}}))}),Hustle.define("Social_Sharing.Listing",function(e,t,i){"use strict";var s=Hustle.get("Delete_Confirmation");return Backbone.View.extend({el:"#wph-ccontent--modules",events:{"click .wph-accordions header":"toggle_accordion","change .social-sharing-toggle-activity":"toggle_activity","change .social-sharing-toggle-tracking-activity":"toggle_tracking_activity","change .social-sharing-toggle-type-activity":"toggle_type_activity","change .social-sharing-toggle-test-activity":"toggle_test_activity","click .social-sharing-edit":"edit","click .social-sharing-delete":"delete"},delete_confirmations:{},initialize:function(){},toggle_accordion:function(t){if(_.indexOf(["wph-accordion--animate_buttons","wph-icon i-arrow"],t.target.className)!==-1){var i=e(t.target),s=i.find(".dev-icon"),n=i.closest("li");n.find("section");s.toggleClass("dev-icon-caret_down dev-icon-caret_up"),n.toggleClass("wph-accordion--closed wph-accordion--open"),n.siblings("li.wph-accordion--open").toggleClass("wph-accordion--closed wph-accordion--open")}},toggle_activity:function(t){t.stopPropagation();var i=e(t.target),s=i.data("id"),n=i.data("nonce"),o=i.is(":checked");i.attr("disabled",!0),e.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_social_sharing_toggle_activity",id:s,_ajax_nonce:n},complete:function(){i.attr("disabled",!1)},success:function(e){e.success||i.attr("checked",!o)},error:function(){i.attr("checked",!o)}})},toggle_tracking_activity:function(t){t.stopPropagation();var i=e(t.target),s=i.data("id"),n=i.data("nonce"),o=i.data("type"),a=i.is(":checked");i.attr("disabled",!0),e.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_social_sharing_toggle_tracking_activity",id:s,type:o,_ajax_nonce:n},complete:function(){i.attr("disabled",!1)},success:function(e){e.success||i.attr("checked",!a)},error:function(e){e.success||i.attr("checked",!a)}})},toggle_type_activity:function(t){t.stopPropagation();var i=e(t.target),s=i.data("id"),n=i.data("nonce"),o=i.data("type"),a=i.is(":checked");i.attr("disabled",!0),e.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_social_sharing_toggle_type_activity",id:s,type:o,_ajax_nonce:n},complete:function(){i.attr("disabled",!1)},success:function(e){e.success||i.attr("checked",!a)},error:function(e){e.success||i.attr("checked",!a)}})},toggle_test_activity:function(t){t.stopPropagation();var i=e(t.target),s=i.data("id"),n=i.data("nonce"),o=i.data("type"),a=i.is(":checked");i.attr("disabled",!0),e.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_social_sharing_toggle_test_activity",id:s,type:o,_ajax_nonce:n},complete:function(){i.attr("disabled",!1)},success:function(e){e.success||i.attr("checked",!a)},error:function(e){e.success||i.attr("checked",!a)}})},edit:function(e){e.stopPropagation()},"delete":function(e){e.stopPropagation();var t=this.$(e.target);if(!t.prev(".hustle-delete-module-confirmation").length){var i=t.closest("li.wph-accordions--item"),n=(t.data("id"),new s({id:t.data("id"),nonce:t.data("nonce"),action:"hustle_social_sharing_delete",onSuccess:function(e){e.success&&(n.remove(),i.toggle("highlight"))}}));t.before(n.$el)}}})}),Hustle.define("Social_Sharing.Models",function(){"use strict";var e=Hustle.get("Models.M").extend({defaults:{optin_name:"",optin_title:"",optin_provider:"social_sharing",active:1,test_mode:0,service_type:"native",click_counter:1,social_icons:""}}),t=Hustle.get("Models.M").extend({defaults:{icon_style:"four",icons_order:"",customize_colors:0,icon_bg_color:"rgba(146, 158, 170, 1)",icon_color:"rgba(255, 255, 255, 1)",floating_social_bg:"rgba(4, 48, 69, 1)",drop_shadow:0,drop_shadow_x:0,drop_shadow_y:0,drop_shadow_blur:0,drop_shadow_spread:0,drop_shadow_color:"rgba(0,0,0,0)",floating_inline_count:0,counter_border:"rgba(146, 158, 170, 1)",counter_text:"rgba(255, 255, 255, 1)",customize_widget_colors:0,widget_icon_bg_color:"rgba(146, 158, 170, 1)",widget_icon_color:"rgba(255, 255, 255, 1)",widget_bg_color:"rgba(146, 158, 170, 1)",widget_drop_shadow:0,widget_drop_shadow_x:0,widget_drop_shadow_y:0,widget_drop_shadow_blur:0,widget_drop_shadow_spread:0,widget_drop_shadow_color:"rgba(0,0,0,0)",widget_inline_count:0,widget_counter_text:"rgba(255, 255, 255, 1)"}}),i=Hustle.get("Models.M").extend({defaults:{enabled:!1,conditions:"",location_type:"screen",location_target:"",location_align_x:"left",location_align_y:"top",location_top:0,location_bottom:0,location_right:0,location_left:0},initialize:function(e){if(_.extend(this,e),!(this.get("conditions")instanceof Backbone.Model)){_.isEmpty(this.get("conditions"))&&_.isArray(this.get("conditions"))&&(this.conditions={});
var t=Hustle.get("Model");this.set("conditions",new t(this.conditions))}this.on("change",this.user_has_change,this)}}),s=i.extend();return{Services:e,Appearance:t,TypeBase:i,Floating_Social:s}}),Hustle.define("Social_Sharing.Services_View",function(e,t,i){"use strict";return Hustle.View.extend(_.extend({},Hustle.get("Mixins.Model_Updater"),{template:Optin.template("wpoi-social-sharing-services-tpl"),init:function(e){return this.render()},render:function(e){return this.setElement(this.template(_.extend({},this.model.toJSON()))),this}}))}),Hustle.define("Social_Sharing.View",function(e,t,i){"use strict";return Hustle.View.extend({el:".wph-sshare-wizard-view",message_box_tpl:Optin.template("wpoi-social-sharing-message-box-tpl"),preview:!1,preview_model:!1,initial_data:new Backbone.Model({content:""}),events:{"click .wph-toggletabs .can-open":"toggle_accordion","click ul.wph-ss-service-type li label":"toggle_service_type","click .wph-button.ss-save-changes":"ss_save","click .wph-button.ss-cancel":"ss_cancel","click .wph-button.ss-next-step":"ss_next_step","click .wph-button.ss-back":"ss_back","click .wph-button.ss-finish":"ss_finish","change .wph-sshare--pick_social_icons input.wph-share-icon-enable":"toggle_icon","change .wph-sshare--pick_social_icons .wph-input--number input":"icon_counter_updated","change .wph-sshare--pick_social_icons .wph-sshare--input_wrap input":"icon_link_updated",'click ul.wph-share-icon_style [name="wph-sshare-type_icons_design"]':"toggle_icon_style","click ul.wph-share-customize-color li > label":"toggle_floating_custom_color","click ul.wph-share-widget-customize-color li > label":"toggle_widget_custom_color","click ul.wph-sshare--pick_location_type li > label":"toggle_location_type","click ul.wph-sshare--select_location_align_x li > label":"toggle_location_align","click ul.wph-sshare--select_location_align_y li > label":"toggle_location_align"},init:function(e){return this.services_view=e.services_view,this.appearance_view=e.appearance_view,this.floating_view=e.floating_view,this.listenTo(this.model,"change",this.render_message_box),this.listenTo(this.services_view.model,"change:service_type",this.services_view_changes),this.listenTo(this.services_view.model,"change:click_counter",this.services_view_changes),this.listenTo(this.appearance_view.model,"change:icons_order",this.icons_order_updated),this.listenTo(this.appearance_view.model,"change:drop_shadow",this.appearance_view_changes),this.listenTo(this.appearance_view.model,"change:customize_colors",this.appearance_view_changes),this.listenTo(this.appearance_view.model,"change:customize_widget_colors",this.appearance_view_changes),this.listenTo(this.appearance_view.model,"change:widget_drop_shadow",this.appearance_view_changes),this.listenTo(this.appearance_view.model,"change:floating_inline_count",this.appearance_view_changes),this.listenTo(this.appearance_view.model,"change:widget_inline_count",this.appearance_view_changes),this.listenTo(this.appearance_view.model,"change",_.debounce(this.render_preview,100)),this.render_message_box(),this.render()},render:function(){this.render_service_view(),this.render_appearance_view();var e=this.$("#wph-social-sharing--floating-social-container"),t=e.attr("class");e.replaceWith(this.floating_view.$el.addClass(t).attr("id","wph-social-sharing--floating-social-container"))},render_service_view:function(){this.$("#wph-social-sharing--services_tab .wph-toggletabs--content").html(""),this.services_view.delegateEvents(),this.$("#wph-social-sharing--services_tab .wph-toggletabs--content").append(this.services_view.$el)},render_appearance_view:function(){this.$("#wph-social-sharing--appearance_tab .wph-toggletabs--content").html(""),this.appearance_view.delegateEvents(),this.$("#wph-social-sharing--appearance_tab .wph-toggletabs--content").append(this.appearance_view.$el),Hustle.Events.trigger("SS.appearance_view_ready"),this.render_preview()},services_view_changes:function(){Optin.hasChanges=!0,this.services_view.render(),this.render_service_view(),this.appearance_view_changes()},appearance_view_changes:function(){Optin.hasChanges=!0,this._set_social_icons(),this.appearance_view.render(),this.render_appearance_view()},render_message_box:function(){var e=this._get_shortcode_id();this.$("#wph-social-sharing--messagebox").html(this.message_box_tpl({shortcode_id:e}))},render_preview:function(){var e=this.$("#wph-sshare--floating_social .wph-sshare--preview_box .wph-sshare--container"),t=this.$("#wph-sshare--widget_shortcode .wph-sshare--preview_box .wph-sshare--container"),i=this.appearance_view.model.toJSON();if(e.css("background",i.floating_social_bg),i.counter_text&&e.find(".wph-sshare_social_counter span").css("color",i.counter_text),"1"==i.customize_colors&&("one"==i.icon_style&&(e.find("a").css("background",i.icon_bg_color),e.find(".wph-social-path .wph-social-icon").css("fill",i.icon_color)),"two"==i.icon_style&&(e.find(".wph-social").css("border-color",i.icon_bg_color),e.find(".wph-social .wph-social-icon").css("fill",i.icon_color)),"three"!=i.icon_style&&"four"!=i.icon_style||(e.find(".wph-social").css("background",i.icon_bg_color),e.find(".wph-social .wph-social-icon").css("fill",i.icon_color)),i.counter_border&&e.find("a").css("border","1px solid "+i.counter_border)),"1"==i.drop_shadow){var s=""+i.drop_shadow_x+"px "+i.drop_shadow_y+"px "+i.drop_shadow_blur+"px "+i.drop_shadow_spread+"px "+i.drop_shadow_color;e.css("box-shadow",s)}if(t.css("background",i.widget_bg_color),t.find(".wph-sshare_social_counter span").css("color",i.widget_counter_text),"1"==i.customize_widget_colors&&("one"==i.icon_style&&(t.find("a").css("background",i.widget_icon_bg_color),t.find(".wph-social-path .wph-social-icon").css("fill",i.widget_icon_color)),"two"==i.icon_style&&(t.find(".wph-social").css("border-color",i.widget_icon_bg_color),t.find(".wph-social .wph-social-icon").css("fill",i.widget_icon_color)),"three"!=i.icon_style&&"four"!=i.icon_style||(t.find(".wph-social").css("background",i.widget_icon_bg_color),t.find(".wph-social .wph-social-icon").css("fill",i.widget_icon_color))),"1"==i.widget_drop_shadow){var n=""+i.widget_drop_shadow_x+"px "+i.widget_drop_shadow_y+"px "+i.widget_drop_shadow_blur+"px "+i.widget_drop_shadow_spread+"px "+i.widget_drop_shadow_color;t.css("box-shadow",n)}},toggle_accordion:function(t){t.preventDefault();var i=e(t.target),s=e(".wph-toggletabs"),n=i.closest(".wph-toggletabs"),o=s.not(n),a=n.find(".dev-icon-caret_down, .dev-icon-caret_up");o.removeClass("wph-toggletabs--open"),o.find(".dev-icon-caret_up").removeClass("dev-icon-caret_up").addClass("dev-icon-caret_down"),n.toggleClass("wph-toggletabs--open wph-toggletabs--closed"),a.toggleClass("dev-icon-caret_down dev-icon-caret_up")},toggle_service_type:function(t){t.preventDefault(),Optin.hasChanges=!0;var i=this.$(t.target);i.closest("li").hasClass("current")||this.model.set("service_type",e(t.target).find("input").val())},toggle_icon:function(e){var t=this.$(e.target),i=t.is(":checked"),s=this.services_view.model.get("service_type"),n=t.parents(".wph-sshare--social_"+s);i?n.find(".disabled").removeClass("disabled"):(n.find(".wph-sshare--icon").addClass("disabled"),"native"==s?n.find(".wph-input--number").addClass("disabled"):n.find(".wph-sshare--input_wrap").addClass("disabled")),this.appearance_view_changes()},icons_order_updated:_.debounce(function(){this.appearance_view_changes()},500),icon_counter_updated:_.debounce(function(){this.appearance_view_changes()},500),icon_link_updated:function(e){this._set_social_icons()},toggle_icon_style:function(e){e.preventDefault();var t=this.$(e.target);t.closest("li").hasClass("current")||(this.appearance_view.model.set("icon_style",t.val(),{silent:!0}),this.appearance_view.render(),this.render_appearance_view())},toggle_floating_custom_color:function(e){e.preventDefault();var t=this.$(e.target),i=t.closest("li"),s=i.find("input");i.hasClass("current")||(i.addClass("current"),i.siblings().removeClass("current"),this.appearance_view.model.set("customize_colors",s.val()))},toggle_widget_custom_color:function(e){e.preventDefault();var t=this.$(e.target),i=t.closest("li"),s=i.find("input");i.hasClass("current")||(i.addClass("current"),i.siblings().removeClass("current"),this.appearance_view.model.set("customize_widget_colors",s.val()))},toggle_location_type:function(e){e.preventDefault();var t=this.$(e.target),i=t.closest("li"),s=i.find("input"),n=this.$(".wph-sshare--selector");i.hasClass("current")||(i.addClass("current"),i.siblings().removeClass("current"),this.floating_view.model.set("location_type",s.val()),"selector"==s.val()?n.removeClass("hidden"):n.hasClass("hidden")||n.addClass("hidden"))},toggle_location_align:function(t){t.preventDefault();var i=this.$(t.target),s=i.closest("li"),n=s.find("input"),o=this.$(".wph-sshare--offset_"+n.val()),a=n.data("attribute");s.hasClass("current")||(s.addClass("current"),s.siblings().removeClass("current"),this.floating_view.model.set(a,n.val()),o.removeClass("hidden"),o.siblings('[class^="wph-sshare--offset_"]').each(function(){e(this).hasClass("hidden")||e(this).addClass("hidden")}))},ss_save:function(t){if(t.preventDefault(),this.validate()){var i=this,s=this.$(t.target).closest("button"),n=s.data("id"),o=s.parents(".row").find("button.wph-button"),a=this.services_view.model.toJSON(),l=this.appearance_view.model.toJSON(),r=this.floating_view.model.toJSON(),c=this._get_shortcode_id();return s.addClass("wph-button-save--loading"),o.each(function(){e(this).attr("disabled",!0)}),a=this._get_social_icons_data(a),e.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_social_sharing_save",_ajax_nonce:s.data("nonce"),id:s.data("id"),services:a,appearance:l,floating_social:r,shortcode_id:c},complete:function(t){var a=t.responseJSON,l=i.$('button.wph-button[data-id="'+n+'"]');if(s.removeClass("wph-button-save--loading"),o.each(function(){e(this).attr("disabled",!1)}),Optin.hasChanges=!1,n==-1){l.attr("data-id",a.data);var r=window.location.pathname+window.location.search;r=r.replace("id=-1","id="+a.data),window.history.replaceState({},"",r)}}})}},ss_cancel:function(e){e.preventDefault(),window.onbeforeunload=null,window.location.replace("?page=inc_hustle_social_sharing")},ss_next_step:function(e){if(e.preventDefault(),this.validate()){var t=this.$(".wph-toggletabs.wph-toggletabs--open ~ .wph-toggletabs").first();this.ss_save(e).done(function(e){e.success&&t.find(".can-open span").click()})}},ss_back:function(e){e.preventDefault();var t=this.$(".wph-toggletabs.wph-toggletabs--open").prevAll(".wph-toggletabs").first();t.find(".can-open span").click()},ss_finish:function(e){if(e.preventDefault(),this.validate()){var t=this.$(e.target),i=parseInt(t.data("id"))==-1;this.ss_save(e).done(function(e){if(e.success){window.onbeforeunload=null;var t="?page=inc_hustle_social_sharing";t+=i?"&new_id="+e.data:"&updated_id="+e.data,window.location.replace(t)}})}},validate:function(){var t=!0,i=this.$('[data-attribute="optin_name"]'),s=i.attr("placeholder");if(!i.val()){if(t=!1,0===i.siblings("span.wph-icon.i-warning").length){var n=e('<span class="wph-icon i-warning" title="'+s+'"></span>');n.insertBefore(i)}i.focus()}return t&&e("span.dashicons.dashicons-warning").remove(),t},_set_social_icons:function(){Optin.hasChanges=!0;var e=this.services_view.model.toJSON();e=this._get_social_icons_data(e),this.services_view.model.set("social_icons",e.social_icons,{silent:!0}),window.services_model=this.services_view.model},_get_social_icons_data:function(t){var i=this.$(".wph-sshare--social_"+t.service_type),s={};return i.each(function(){var t=e(this),i=t.find("span.toggle input"),n=t.find(".wph-sshare--icon").data("id"),o=t.find(".wph-input--number input"),a=t.find(".wph-sshare--input_wrap input"),l=parseInt(o.val());l<0&&o.val(0),i.is(":checked")&&(s[n]={enabled:!0,counter:o.length?o.val():"0",link:a.length?a.val():""})}),t.social_icons=s,t},_get_shortcode_id:function(){return this.model.get("optin_name").trim().toLowerCase().replace(/\s+/g,"-")}})}),Hustle.define("Legacy_Popups.Listing",function(e){"use strict";return Backbone.View.extend({el:"#wph-ccontent--migration",events:{"click .custom-content-legacy-toggle-activity":"toggle_activity","click .wph-button-legacy-quickedit-btn":"toggle_quick_edit","click .custom-content-legacy-popup-save-quickedit":"save_quick_edit","click .wph-button-legacy-migrate-btn":"migrate"},initialize:function(){},toggle_activity:function(t){var i=this.$(t.target),s=i.data("id"),n=i.data("nonce"),o=i.is(":checked");i.prop("disabled",!0),e.ajax({url:ajaxurl,data:{action:"hustle_legacy_popup_toggle_activity",id:s,target_state:o,_ajax_nonce:n},complete:function(){i.prop("disabled",!1)},success:function(e){e.success||i.prop("checked",!o)},error:function(){i.prop("checked",!o)}})},toggle_quick_edit:function(e){var t=this.$(e.target),i=t.closest("li");t.toggleClass("wph-button--open wph-button--closed"),i.toggleClass("wph-accordion--open wph-accordion--closed")},save_quick_edit:function(t){var i=this,s=this.$(t.target),n=s.closest("li"),o={action:"hustle_custom_content_legacy_popup_quick_edit_save",content:n.find(".hustle-custom-content-legacy-popup-content").val(),heading:n.find(".hustle-custom-content-legacy-popup-heading").val(),subheading:n.find(".hustle-custom-content-legacy-popup-subheading").val(),id:s.data("id"),_ajax_nonce:s.data("nonce")},a=e("<span class='button-spinner'>"),l=n.find(".wph-button-legacy-quickedit-btn")[0],r=s.outerWidth();s.append(a).animate({width:r+.3*r}).attr("disabled",!0),e.ajax({url:ajaxurl,data:o,complete:function(){s.animate({width:r}).attr("disabled",!1).find(".button-spinner").remove()},success:function(e){e.success&&i.toggle_quick_edit({target:l})}})},migrate:function(t){var i=this.$(t.target),s=i.closest("li"),n=i.data("id"),o=i.data("nonce"),a=e("<span class='button-spinner'>"),l=i.outerWidth();i.append(a).animate({width:l+.3*l}).attr("disabled",!0),e.ajax({url:ajaxurl,data:{action:"hustle_custom_content_legacy_popup_migrate",id:n,_ajax_nonce:o},complete:function(){i.animate({width:l}).attr("disabled",!1).find(".button-spinner").remove()},success:function(e){s.slideUp(300,function(){s.remove()})}})}})}),Hustle.define("Custom_Content.Module",function(e){"use strict";!function(){if("hustle_page_inc_hustle_custom_content"===pagenow){var e=Hustle.get("Custom_Content.Listing"),t=(new e,Hustle.get("Legacy_Popups.Listing"));new t}}(),function(){if(_.indexOf(["hustle_page_inc_hustle_custom_content_new","hustle_page_inc_hustle_custom_content_edit"],pagenow)!==-1&&!parseInt(optin_vars.current.is_cc_limited)){var e=Hustle.get("Custom_Content.View"),t=Hustle.get("Custom_Content.Content_View"),i=Hustle.get("Custom_Content.Design_View"),s=Hustle.get("Custom_Content.After_Content_View"),n=Hustle.get("Custom_Content.Popup_View"),o=Hustle.get("Custom_Content.Slide_In_View"),a=Hustle.get("Settings.Display_Triggers_View"),l=Hustle.get("Settings.Conditions_View"),r=Hustle.get("Custom_Content.Models.Content"),c=Hustle.get("Custom_Content.Models.Design"),d=Hustle.get("Custom_Content.Models.AfterContent"),p=Hustle.get("Custom_Content.Models.Popup"),h=Hustle.get("Custom_Content.Models.Slide_In"),u=Hustle.get("Custom_Content.Models.Magic_Bar"),g=new r(optin_vars.current.content||{}),m=new d(optin_vars.current.after_content||{}),w=new c(optin_vars.current.design||{}),v=new p(optin_vars.current.popup||{}),f=new h(optin_vars.current.slide_in||{}),b=new u(optin_vars.current.magic_bar||{});return window.content_model=g,window.design_model=w,window.after_content_model=m,window.popup_model=v,window.slide_in_model=f,window.magic_bar_model=b,new e({model:g,content_view:new t({model:g,design_model:w}),design_view:new i({model:w}),after_content_view:new s({type:"after_content",model:m,display_triggers_view:new a({model:m.get("triggers"),type:"after_content"}),conditions_view:new l({model:m.get("conditions"),type:"after_content"})}),popup_view:new n({type:"popup",model:v,display_triggers_view:new a({model:v.get("triggers"),type:"popup"}),conditions_view:new l({model:v.get("conditions"),type:"popup"})}),slide_in:new o({type:"slide_in",model:f,display_triggers_view:new a({model:f.get("triggers"),type:"slide_in"}),conditions_view:new l({model:f.get("conditions"),type:"slide_in"})}),magic_bar:new Backbone.View({model:b})})}}()}),Hustle.define("Social_Sharing.Module",function(e){"use strict";!function(){if("hustle_page_inc_hustle_social_sharing"===pagenow){var e=Hustle.get("Social_Sharing.Listing");new e}}(),function(){if(_.indexOf(["hustle_page_inc_hustle_social_sharing_new","hustle_page_inc_hustle_social_sharing_edit"],pagenow)!==-1&&!parseInt(optin_vars.current.is_ss_limited)){var e=Hustle.get("Social_Sharing.View"),t=Hustle.get("Social_Sharing.Services_View"),i=Hustle.get("Social_Sharing.Appearance_View"),s=Hustle.get("Social_Sharing.Floating_View"),n=Hustle.get("Settings.Conditions_View"),o=Hustle.get("Social_Sharing.Models.Services"),a=Hustle.get("Social_Sharing.Models.Appearance"),l=Hustle.get("Social_Sharing.Models.Floating_Social"),r=new o(optin_vars.current.services||{}),c=new a(optin_vars.current.appearance||{}),d=new l(optin_vars.current.floating_social||{});return window.services_model=r,window.appearance_model=c,window.floating_social_model=d,new e({model:r,services_view:new t({model:r}),appearance_view:new i({model:c}),floating_view:new s({type:"floating_social",model:d,conditions_view:new n({model:d.get("conditions"),type:"floating_social"})})})}}()}),Hustle.define("Optin.Error_List_Modal",function(e){"use strict";var t=Backbone.View.extend({tagName:"tr",template:Optin.template("wpoi-error-list-tpl"),controller:!1,initialize:function(e){this.controller=e.controller,this.module_fields=e.module_fields,this.render()},render:function(){var e=this.template({model:this.model,module_fields:this.module_fields});this.$el.html(e),this.$el.appendTo(this.controller.$("#wpoi-error-list"))}});return Backbone.View.extend({id:"wpoi-error-list-modal",button:!1,list:[],template:Optin.template("wpoi-error-list-modal-tpl"),header_template:Optin.template("wpoi-error-header-list-tpl"),hasHeader:!1,events:{"click .inc-opt-close-error-list":"toggleErrorLog","click .button-clear-logs":"clearLogs","click .button-delete-logs":"_clean","click .button-cancel-delete-logs":"cancelDelete"},initialize:function(e){this.button=e.button,this.render()},render:function(){var i=this,s=this.template(this.model);this.$el.html(s),this.$el.appendTo("body"),this.clearLogButton=this.$(".button-clear-logs"),this.exportButton=this.$(".button-download-csv"),this.deleteConfirmation=this.$(".hustle-delete-logs-confirmation"),this.header=this.$(".wph-table-header"),this.button.addClass("loading"),e.getJSON(window.ajaxurl,{optin_id:this.model.optin_id,_wpnonce:optin_vars.error_log_nonce,action:"get_error_list"},function(e){e.success&&e.data&&e.data.logs&&(i.header.html(i.header_template({headers:e.data.module_fields})),_.each(e.data.logs,function(s){new t({module_fields:e.data.module_fields,model:s,controller:i})}),i.show())})},show:function(){this.$el.addClass("show")},toggleErrorLog:function(){this.$el.removeClass("show")},clearLogs:function(){this.deleteConfirmation.show(),this.clearLogButton.attr("disabled",!0),this.exportButton.attr("disabled",!0)},_clean:function(){var t=this;e.get(window.ajaxurl,{optin_id:this.model.optin_id,_wpnonce:optin_vars.clear_log_nonce,action:"clear_logs"},function(e){e.success&&(t.toggleErrorLog(),_.delay(function(){t.button.remove(),t.remove()},350))})},cancelDelete:function(){this.deleteConfirmation.hide(),this.clearLogButton.removeAttr("disabled"),this.exportButton.removeAttr("disabled")}})}),Hustle.define("Optin.Listing",function(e){"use strict";var t=Hustle.get("Delete_Confirmation");return Backbone.View.extend({el:"#hustle-optin-listing",logShown:!1,events:{"click .wph-accordions header":"toggle_optin_accordion","click .hustle-delete-optin":"delete_optin","click .optin-active-state":"toggle_optin_activity","click .button-view-email-list":"view_email_list","change  .optin-type-active-state":"toggle_type_activity","change  .wpoi-testmode-active-state":"toggle_type_mode_activity","change .optin-toggle-tracking-activity":"toggle_tracking_activity","click .button-view-log-list":"view_error_log_list"},initialize:function(){var t=this;this.$(".optin-type-active-state").each(function(){t.set_testmode_visibiliy(e(this),0)})},toggle_optin_accordion:function(t){if(_.indexOf(["wph-accordion--animate_buttons","wph-icon i-arrow"],t.target.className)!==-1){var i=e(t.target),s=i.find(".dev-icon"),n=i.closest("li");n.find("section");s.toggleClass("dev-icon-caret_down dev-icon-caret_up"),n.toggleClass("wph-accordion--closed wph-accordion--open"),n.siblings("li.wph-accordion--open").toggleClass("wph-accordion--closed wph-accordion--open")}},delete_optin:function(i){i.preventDefault(),i.stopPropagation();var s=this.$(i.target);if(!s.prev(".hustle-delete-module-confirmation").length){var n=(s.closest("li.wph-accordions--item"),s.data("id"),new t({id:s.data("id"),nonce:s.data("nonce"),action:"inc_opt_delete_optin",onSuccess:function(t){t.success&&s.closest("li").slideUp(300,function(){e(this).remove()})}}));s.before(n.$el)}},toggle_optin_activity:function(t){var i=this.$(t.target),s=i.data()||{},n=i.closest(".wph-accordions--item").find(".wph-accordion--disable"),o=i.closest("li");s.action="inc_opt_toggle_state",s._ajax_nonce=s.nonce,i.prop("disabled",!0),i.is(":checked")?(n.addClass("hidden"),o.removeClass("wph-accordion--closed").addClass("wph-accordion--open")):(n.removeClass("hidden"),o.addClass("wph-accordion--closed").removeClass("wph-accordion--open")),e.post(ajaxurl,s,function(e){i.prop("disabled",!1)})},view_email_list:function(t){t.preventDefault(),t.stopPropagation();var i=e(t.target),s=i.data("id"),n=i.data("name"),o=i.data("total"),a=Hustle.get("Optin.Subscription_List_Modal");new a({model:{id:s,total:o,name:n,module_fields:[]}})},set_testmode_visibiliy:function(e,t){"undefined"==typeof t&&(t=400);var i=e,s=i.data()||{},n=this.$('.wpoi-testmode-active-state[data-id="'+s.id+'"][data-type="'+s.type+'"]').closest(".test-mode");i.is(":checked")?n.fadeOut(t):n.fadeIn(t)},toggle_tracking_activity:function(t){t.stopPropagation();var i=e(t.target),s=i.data("id"),n=i.data("nonce"),o=i.data("type"),a=i.is(":checked");i.attr("disabled",!0),e.ajax({url:ajaxurl,type:"POST",data:{action:"inc_optin_toggle_tracking_activity",id:s,type:o,_ajax_nonce:n},complete:function(){i.attr("disabled",!1)},success:function(e){e.success||i.attr("checked",!a)},error:function(e){e.success||i.attr("checked",!a)}})},toggle_type_activity:function(t){var i=e(t.target),s=i.data()||{};this.set_testmode_visibiliy(i),e('.optin-type-active-state[data-id="'+s.id+'"][data-type="'+s.type+'"]').not(this).prop("checked",!!i.is(":checked")),s.action="inc_opt_toggle_optin_type_state",s._ajax_nonce=s.nonce,i.prop("disabled",!0),e.post(ajaxurl,s,function(e){i.prop("disabled",!1)})},toggle_type_mode_activity:function(t){var i=e(t.target),s=i.data()||{};s.action="inc_opt_toggle_type_test_mode",s._ajax_nonce=s.nonce,e('.wpoi-testmode-active-state[data-id="'+s.id+'"][data-type="'+s.type+'"]').not(this).prop("checked",!!i.is(":checked")),i.prop("disabled",!0),e.post(ajaxurl,s,function(e){i.prop("disabled",!1)})},view_error_log_list:function(t){var i=e(t.currentTarget),s=i.data(),n=s.id,o=s.name,a=Hustle.get("Optin.Error_List_Modal");this.logShown?this.logShown.show():this.logShown=new a({button:i,model:{name:o,optin_id:n,total:s.total}})}})}),Hustle.define("Optin.Preview",function(e){"use strict";return Backbone.View.extend({el:".wph-preview",preview_modal:!1,$preview_yield:!1,wrapper_class_tpl:Hustle.create_template("wph-preview--optin wph-preview--{{type}}"),events:{"click .wph-preview--mask":"hide","click .wph-preview--close":"hide","change #wph-preview-type-selector":"change_type"},initialize:function(){this.$preview_yield=this.$("#optin-preview-wrapper"),this.render(),this.listenTo(this.preview_modal.model,"change",this.render),this.$("#wph-preview-type-selector").val(this.model.get("type"))},get_tpl:function(e){var t=["optin-layout-one","optin-layout-two","optin-layout-three","optin-layout-four"];return Hustle.template(t[e])},render:function(){var e=Hustle.get("Modal");this.preview_modal=new e({model:this.model,template:this.get_tpl(this.model.get("form_location").toInt())}),this.$preview_yield.replaceWith(this.preview_modal.$el),this.$preview_yield=this.preview_modal.$el,this.preview_modal.show(),this.$("#wph-preview-type-selector").val(this.model.get("type")),Hustle.Events.trigger("view.rendered",this)},show:function(){this.$el.removeClass("wph-preview--closed").addClass("wph-preview--open"),this.$(".wph-preview--optin").attr("class",this.wrapper_class_tpl({type:this.model.get("type")})),Optin.Events.trigger("design:preview:render:finish",this.preview_modal)},hide:function(e){this.$el.removeClass("wph-preview--open").addClass("wph-preview--closed")},change_type:function(e){var t=this.$(e.target).val();this.preview_modal.model.set("type",t),this.$(".wph-preview--optin").attr("class",this.wrapper_class_tpl({type:t})),Optin.Events.trigger("design:preview:render:finish",this.preview_modal),Hustle.Events.trigger("Optin.preview.changed.type",this)}})}),Hustle.define("Optin.Subscription_List_Modal",function(e){"use strict";var t={};return Backbone.View.extend({id:"wpoi-emails-list-modal",template:Optin.template("wpoi-emails-list-modal-tpl"),list_header_template:Optin.template("wpoi-email-list-header-tpl"),list_template:Optin.template("wpoi-emails-list-tpl"),show_delay:350,events:{"click .inc-opt-close-emails-list":"close","click .wpoi-complete-mask":"close"},initialize:function(){return this.render()},render:function(){var i=this,s=this.template(this.model);return s=s.replace("__id",this.model.id),this.$el.html(s),t[this.model.id]||(t[this.model.id]=e.ajax({url:ajaxurl,type:"GET",data:{action:"inc_optin_get_email_lists",id:this.model.id,_ajax_nonce:e("#wpoi_get_emails_list_nonce").val()}}),this.delay_show=0),t[this.model.id].then(function(e){if(e.success){var t=e.data.module_fields,s=[];i.model.module_fields.length||(i.model.module_fields=t,i.$(".wpoi-emails-list-header").html(i.list_header_template({module_fields:t})),_.each(t,function(e){s.push({name:e.name,label:e.label})}));var n=i.list_template({subscriptions:e.data.subscriptions,module_fields:s});i.$("#wpoi-emails-list-content").html(n),i.show()}}),this.$el.appendTo("body"),this},show:function(){_.delay(function(){this.$el.addClass("show")}.bind(this),this.show_delay)},close:function(e){e.preventDefault(),this.$el.removeClass("show"),_.delay(function(){this.remove()}.bind(this),350)}})}),Hustle.define("Optin.Module",function(){"use strict";if("hustle_page_inc_optin_listing"===pagenow){var e=Hustle.get("Optin.Listing");new e}}),Hustle.define("Dashboard.View",function(e,t,i){"use strict";if("toplevel_page_inc_optins"===pagenow&&!_.isTrue(optin_vars.is_free)){var s=Backbone.View.extend({el:".wph-dashboard",conversions_chart:null,chart_data:null,chart_options:null,empty_chart:!0,default_dataset_options:{fill:!1,cubicInterpolationMode:"monotone",borderCapStyle:"butt",borderDash:[],borderWidth:1,borderDashOffset:0,borderJoinStyle:"miter",pointBackgroundColor:"#fff",pointBorderWidth:3,pointHoverRadius:5,pointHoverBorderColor:"rgba(220,220,220,1)",pointHoverBorderWidth:2,pointRadius:1,pointHitRadius:10,spanGaps:!1},events:{"click .wph-icon.i-close":"close"},initialize:function(t){for(var i=[],s=0;s<hustle_vars.conversion_chart_data.length;s++){hustle_vars.conversion_chart_data[s].data.length>=1&&(this.empty_chart=!1);var n={label:hustle_vars.conversion_chart_data[s].module_name,data:hustle_vars.conversion_chart_data[s].data,backgroundColor:hustle_vars.conversion_chart_data[s].color,borderColor:hustle_vars.conversion_chart_data[s].color,pointBorderColor:hustle_vars.conversion_chart_data[s].color,pointHoverBackgroundColor:hustle_vars.conversion_chart_data[s].color};i.push(e.extend(!0,{},this.default_dataset_options,n))}return this.chart_data={datasets:i},this.chart_options={responsive:!0,maintainAspectRatio:!1,legend:{display:!1},scales:{xAxes:[{type:"time",time:{unit:"week",unitStepSize:3,tooltipFormat:"D MMM",displayFormat:"D MMM",min:hustle_vars.previous_month,max:hustle_vars.today},gridLines:{display:!1}}],yAxes:[{ticks:{min:0},gridLines:{display:!1}}]},tooltips:{callbacks:{label:function(e,t){var i=[];return i.push(e.yLabel+" Conv"),i}},cornerRadius:3,displayColors:!1,backgroundColor:"rgba(11,47,63,1)"},hover:{mode:"nearest",intersect:!0}},this.render()},render:function(){e(".tabs-header li label").on("click",this.toggle_overview),e(".can-close .wph-icon.i-close").on("click",this.close),e("a#wph-sshare_stats_view_all").on("click",this.toggle_sshare_modal),e("a#wph-sshare_stats_close").on("click",this.toggle_sshare_modal),this.handle_sshare_modal_pagination();var t=e("#conversions_chart");if(t.length)if(this.empty_chart){t.parent().css("height","100%").css("width","100%").css("display","table");var i=e('<div class="graph-no-data">'+optin_vars.messages.dashboard.not_enough_data+"</div>");i.css("display","table-cell").css("text-align","center").css("vertical-align","middle"),t.replaceWith(i)}else{var s=t.closest("#wph-module-stats").find("table.wph-table.wph-module--stats"),n=s.outerHeight();n>230?t.attr("height",n):t.attr("height",230);for(var o in this.chart_data.datasets)this.chart_data.datasets[o].data&&(this.chart_data.datasets[o].data=_.sortBy(this.chart_data.datasets[o].data,"x"));this.conversions_chart=new Chart(t,{type:"line",data:this.chart_data,options:this.chart_options})}},close:function(t){t.preventDefault();var i=e(t.target).closest(".row"),s=e(t.target).closest("#wph-welcome"),n=s.data("nonce");i.slideToggle(300,function(){e.ajax({url:ajaxurl,type:"POST",data:{action:"persist_new_welcome_close",_ajax_nonce:n},complete:function(e){i.remove()}})})},toggle_overview:function(t){t.preventDefault();var i=e(t.target),s=i.find("input").val(),n=e("#wph-"+s+"-overview"),o=i.parent();e(".wph-modules-overview").not(n).removeClass("current"),n.addClass("current"),e(".tabs-header li").not(o).removeClass("current"),o.addClass("current")},toggle_sshare_modal:function(t){t.preventDefault();var i=e("#wpoi-sshare-stats-modal");i.toggleClass("show")},handle_sshare_modal_pagination:function(){e("li.wph-sshare--prev_page a").on("click",e.proxy(this.sshare_modal_prev,this)),e("li.wph-sshare--next_page a").on("click",e.proxy(this.sshare_modal_next,this)),e("li.wph-sshare--page_number a").on("click",e.proxy(this.sshare_modal_goto,this))},sshare_modal_prev:function(t){t.preventDefault(),t.stopImmediatePropagation();var i=e(t.target).closest("li"),s=i.parent(),n=s.data("nonce"),o=s.find("li.wph-sshare--current_page"),a=s.find("li.wph-sshare--page_number"),l=s.find("li.wph-sshare--next_page"),r=(parseInt(s.data("total")),parseInt(o.data("page"))),c=parseInt(i.data("page"));o.data("page",c);var d=l.find("i.wph-icon");if(l.data("page",r),d.length&&l.html('<a href="#">'+d[0].outerHTML+"</a>"),1==c){var p=i.find("i.wph-icon");p.length&&i.html("<span>"+p[0].outerHTML+"</span>")}if(a.length)a.data("page",r),a.find("a").text(r);else{var _='<li class="wph-link wph-sshare--page_number" data-page="'+r+'"><a href="#">'+r+"</a></li>";e(_).insertAfter(o)}o.find("span").text(c),i.data("page",c-1),this.handle_sshare_modal_pagination(),this.sshare_show_page_content(c,n)},sshare_modal_next:function(t){t.preventDefault(),t.stopImmediatePropagation();var i=e(t.target).closest("li"),s=i.parent(),n=s.data("nonce"),o=s.find("li.wph-sshare--current_page"),a=s.find("li.wph-sshare--page_number"),l=s.find("li.wph-sshare--prev_page"),r=parseInt(s.data("total")),c=parseInt(o.data("page")),d=parseInt(i.data("page"));o.data("page",d);var p=l.find("i.wph-icon");if(l.data("page",c),p.length&&l.html('<a href="#">'+p[0].outerHTML+"</a>"),d<r){if(a.length){var _=d+1;a.data("page",_),a.find("a").text(_),i.data("page",_)}}else{a.length&&a.remove();var h=i.find("i.wph-icon");h.length&&i.html("<span>"+h[0].outerHTML+"</span>");
}o.find("span").text(d),this.handle_sshare_modal_pagination(),this.sshare_show_page_content(d,n)},sshare_modal_goto:function(t){t.preventDefault(),t.stopImmediatePropagation();var i=e(t.target).closest("li"),s=i.parent();s.find("li.wph-sshare--next_page a").click()},sshare_show_page_content:function(t,i){var s=Optin.template("wpoi-sshare-stats-modal-tpl"),n=e("table#wph-sshare--stats_items");n.html('<div class="wph-sshare--loading_stats"><span class="on-action">Loading...</span></div>'),e.ajax({url:ajaxurl,type:"POST",data:{action:"sshare_show_page_content",page_id:t,_ajax_nonce:i},complete:function(e){var t=e.responseJSON.data,i=s(_.extend({},t));n.replaceWith(i)}})}});new s}}),function(e,t){"use strict";if("hustle_page_inc_hustle_settings"===pagenow){var i=Hustle.get("Settings.E_News"),s=Hustle.get("Settings.Modules_Activity"),n=Hustle.get("Settings.Services");new i,new s,new n}}(jQuery,document),function(e){"use strict";Optin.Provider=function(t){var i=this;return _.extend(this,{id:!1,provider_args:{},errors:{},render_in_previewr:_.noop,init:_.noop,add_args:function(){i.id===Optin.step.services.model.get("optin_provider")&&_.each(i.provider_args,function(t,i){var s=e(t);s.length&&(s=s.val().trim(),Optin.step.services.provider_args.set(i,s))})},clear_provider_args:function(){i.id===Optin.step.services.model.previousAttributes().optin_provider&&i.id!==Optin.step.services.model.get("optin_provider")&&Optin.step.services.provider_args.clear({silent:!0})},validate:function(){var t=[];return _.each(i.provider_args,function(s,n){var o=e(s),a=e("<span></span>");o.length>0&&""===o.val().trim()&&(t.push(i.errors[n]),a.attr("title",i.errors[n].message),o.addClass("wpoi-error"),o.after(a),_.defer(function(){a.addClass("dashicons dashicons-warning "+i.errors[n].iconClass)}))}),_(t)},check_module_field:function(t,i,s){e.getJSON(window.ajaxurl,{action:"add_module_field",provider:this.id,_wpnonce:optin_vars.get_module_field_nonce,optin_id:i,field:t},s).fail(function(){var e={error:!0};s&&s(e)})},validate_custom_field:function(t,i,s){i.$(".dashicons-warning").remove(),i.$("[name]").prop("disabled",!0),this.check_module_field(t,s,function(s){if(i.$("[name]").prop("disabled",!1),s.success)i.options=t,i._updateOptions();else{var n=e('<span class="dashicons dashicons-warning">'),o="custom"!==s.data.code?optin_vars.messages.module_fields[s.data.code]:s.data.message;n.attr("title",o),i.$('[name="label"]').before(n)}})},add_module_field:function(t,i,s){var n=i.$(".wph-add-new-field","#wpoi-module-field-maker");n.addClass("wp-button-save--loading"),n.prop("disabled",!0),this.check_module_field(t,s,function(s){if(n.prop("disabled",!1),s.success)t=s.data.field,i._add_module_field(t);else{var o=e('<span class="dashicons dashicons-warning">'),a="custom"!==s.data.code?optin_vars.messages.module_fields[s.data.code]:s.data.message;o.attr("title",a),n.before(o)}})}},t),this.init(),Optin.Events.on("services:validate:after",e.proxy(this,"add_args")),Optin.Events.on("design:preview:render:start",e.proxy(this,"clear_provider_args")),Optin.Events.on("optin:add_module_field_"+this.id,e.proxy(this,"add_module_field")),Optin.Events.on("optin:update_module_field_"+this.id,e.proxy(this,"validate_custom_field")),this}}(jQuery,document),function(e){"use strict";Optin.Mixins.add_services_mixin("activecampaign",function(){return new Optin.Provider({id:"activecampaign",provider_args:{url:"#optin_url"},errors:{url:{name:"optin_url",message:optin_vars.messages.activecampaign.enter_url,iconClass:"dashicons-warning-account_name"}}})})}(jQuery,document),function(e,t,i){"use strict";Optin.Mixins.add_services_mixin("constantcontact",function(){return new Optin.Provider({id:"constantcontact"})});var s=function(){var t,s,n=e(this),o=n.data("optin"),a=n.attr("href");if(!o){var l=e(".next-button button.wph-button-save","#wpoi-wizard-services");l.trigger("click"),t=setInterval(function(){o=Optin.step.services.model.get("optin_id"),parseInt(o)>0&&(clearInterval(t),s={optin_id:o,_wpnonce:window.optin_vars.constantcontact_nonce,action:"update_constantcontact_referrer"},e.get(ajaxurl,s),_.delay(function(){i.location=a},300))},100)}};e(t).on("click",".constantcontact-authorize",s)}(jQuery,document,window),function(e){"use strict";Optin.Mixins.add_services_mixin("convertkit",function(){return new Optin.Provider({id:"convertkit",provider_args:{api_secret:"#optin_api_secret"},errors:{api_secret:{name:"optin_api_secret",message:optin_vars.messages.convertkit.enter_api_secret,iconClass:"dashicons-warning-account_name"}}})})}(jQuery,document),function(e,t,i){"use strict";Optin.Mixins.add_services_mixin("hubspot",function(){return new Optin.Provider({id:"hubspot"})});var s=function(){var t,s,n=e(this),o=n.data("optin"),a=n.attr("href");if(!o){var l=e(".next-button button.wph-button-save","#wpoi-wizard-services");l.trigger("click"),t=setInterval(function(){o=Optin.step.services.model.get("optin_id"),parseInt(o)>0&&(clearInterval(t),s={optin_id:o,_wpnonce:window.optin_vars.hubspot_nonce,action:"update_hubspot_referrer"},e.get(ajaxurl,s),_.delay(function(){i.location=a},300))},100)}};e(t).on("click",".hubspot-authorize",s)}(jQuery,document,window),function(e){"use strict";Optin.Mixins.add_services_mixin("infusionsoft",function(){return new Optin.Provider({id:"infusionsoft",provider_args:{account_name:"#optin_account_name"},errors:{account_name:{name:"optin_account_name",message:optin_vars.messages.infusionsoft.enter_account_name,iconClass:"dashicons-warning-account_name"}}})})}(jQuery,document),function(e){"use strict";Optin.Mixins.add_services_mixin("mad_mimi",function(){return new Optin.Provider({id:"mad_mimi",provider_args:{username:"#optin_username"},errors:{username:{name:"optin_username",message:optin_vars.messages.sendy.enter_url,iconClass:"dashicons-warning-url"}}})})}(jQuery,document),function(e,t){"use strict";Optin.Mixins.add_services_mixin("mailchimp",function(i){return new Optin.Provider({id:"mailchimp",provider_args:{email_list:"#optin_email_list"},errors:{email_list:{name:"optin_email_list",message:optin_vars.messages.infusionsoft.enter_account_name,iconClass:"dashicons-warning-account_name"}},render_in_previewr:function(e){var t=e.$el?e.$el:e;if(!Optin.step.services.provider_args.isEmpty()&&"mailchimp"===Optin.step.services.model.get("optin_provider")){var i=Optin.template("optin-"+Optin.step.services.model.get("optin_provider")+"-args"),s=Optin.step.services.provider_args.toJSON();s.cta_button=Optin.step.design.model.get("cta_button"),t.find(".wpoi-provider-args").html(i(s))}},init:function(){var s=i,n=s.$("#hustle_service_details_form"),o=e("#wpoi-mailchimp-prev-group-args"),a=function(t){var i=e(t.target),s=e(".wpoi-list-groups"),a=e(".wpoi-list-group-interests-wrap"),l=_.reduce(n.serializeArray(),function(e,t){return e[t.name]=t.value,e},{});l.action="hustle_mailchimp_get_list_groups",l._ajax_nonce=i.data("nonce"),Optin.step.services.provider_args.clear({silent:!0}),a.empty(),o.empty(),e.get(ajaxurl,l).done(function(t){t&&(t.success?(s.html(t.data),s.find("select").wpmuiSelect(),e(".mailchimp_optin_load_more_lists").show()):(e(".mailchimp_optin_load_more_lists").hide(),s.empty()))})},l=function(t){var i=e(".wpoi-list-group-interests-wrap"),s=e(t.target),o=_.reduce(n.serializeArray(),function(e,t){return e[t.name]=t.value,e},{});return["-1","0"].indexOf(t.target.value)!==-1?void i.empty():(o._ajax_nonce=s.data("nonce"),o.action="hustle_mailchimp_get_group_interests",void e.get(ajaxurl,o).done(function(e){if(e&&e.success&&(i.html(e.data.html),Optin.step.services.provider_args.set("group",e.data.group),i.find("select").wpmuiSelect(),e.data.group&&e.data.group.groups&&_.isArray(e.data.group.groups))){Optin.step.services.provider_args.get("group")}e&&!e.success&&i.empty()}).fail(function(e){}))},r=function(t){var i,s=e(t.target);(s.is(":radio")||s.is("select"))&&(i=s.val()),s.is(":checkbox")&&(i=[],e("[name='"+t.target.name+"'").filter(":checked").each(function(){i.push(this.value)})),Optin.step.services.provider_args.set("group",_.extend({},Optin.step.services.provider_args.get("group"),{selected:i}))},c=function(t){t.preventDefault(),e("[name='mailchimp_groups_interests']").prop("checked",!1),Optin.step.services.provider_args.set("group",_.extend({},Optin.step.services.provider_args.get("group"),{selected:[]}))},d=function(t){var i=e(t.target),s=i.closest("form"),n=e(".wpoi-box"),o=s.serialize(),a=e("#optin_new_provider_account_options");e("#wpoi-mailchimp-prev-group-args").empty(),a.html(e("#wpoi_loading_indicator").html()),o+="&action=refresh_provider_account_details&load_more=true",o+="&optin=mailchimp",n.find("*").attr("disabled",!0),Optin.step.services.provider_args.clear({silent:!0}),Optin.step.services.model.set("optin_mail_list","none"),e.post(ajaxurl,o,function(t){n.find("*").attr("disabled",!1),t.success===!0?t.data.redirect_to?window.location.href=t.data.redirect_to:(t.data?a.html(t.data):a.html(optin_vars.messages.something_went_wrong),e(".mailchimp_optin_email_list").wpmuiSelect()):t.data?a.html(t.data):a.html(optin_vars.messages.something_went_wrong)}).fail(function(e){a.html(optin_vars.messages.something_went_wrong)})};e(t).on("change","#optin_email_list.mailchimp_optin_email_list",a),e(t).on("change","#mailchimp_groups",l),e(t).on("change","[name='mailchimp_groups_interests'], [name='mailchimp_groups_interests[]']",r),e(t).on("click",".wpoi-leave-group-intrests-blank-radios",c),e(t).on("click",".mailchimp_optin_load_more_lists",d),Optin.Events.on("design:preview:render:finish",e.proxy(this,"render_in_previewr"))}})})}(jQuery,document),function(e){"use strict";Optin.Mixins.add_services_mixin("mautic",function(){return new Optin.Provider({id:"mautic",provider_args:{url:"#optin_url",username:"#optin_username",password:"#optin_password"},errors:{url:{name:"optin_url",message:optin_vars.messages.mautic.enter_url,iconClass:"dashicons-warning-url"},username:{name:"optin_username",message:optin_vars.messages.mautic.username,iconClass:""},password:{name:"optin_password",message:optin_vars.messages.mautic.password,iconClass:""}}})})}(jQuery,document),function(e){"use strict";var t=["getresponse","campaignmonitor","aweber"];_.each(t,function(e){Optin.Mixins.add_services_mixin(e,function(){return new Optin.Provider({id:e})})})}(jQuery,document),function(e,t){"use strict";Optin.Mixins.add_services_mixin("sendinblue",function(i){return new Optin.Provider({id:"sendinblue",provider_args:{email_list:"#optin_email_list"},errors:{email_list:{name:"optin_email_list",message:optin_vars.messages.infusionsoft.enter_account_name,iconClass:"dashicons-warning-account_name"}},init:function(){var i=function(t){var i=e(t.target),s=i.closest("form"),n=e("#wpoi-wizard-services"),o=s.serialize(),a=e("#optin_new_provider_account_options");e("#wpoi-sendinblue-prev-group-args").empty(),a.html(e("#wpoi_loading_indicator").html()),o+="&action=refresh_provider_account_details&load_more=true",o+="&optin=sendinblue",n.find("input,select,button").attr("disabled",!0),Optin.step.services.provider_args.clear({silent:!0}),Optin.step.services.model.set("optin_mail_list","none"),e.post(ajaxurl,o,function(t){n.find("input,select,button").attr("disabled",!1),t.success===!0?t.data.redirect_to?window.location.href=t.data.redirect_to:(t.data?a.html(t.data):a.html(optin_vars.messages.something_went_wrong),e(".sendinblue_optin_email_list").wpmuiSelect()):t.data?a.html(t.data):a.html(optin_vars.messages.something_went_wrong)}).fail(function(e){a.html(optin_vars.messages.something_went_wrong)})};e(t).on("click",".sendinblue_optin_load_more_lists",i)}})})}(jQuery,document),function(e){"use strict";Optin.Mixins.add_services_mixin("sendy",function(){return new Optin.Provider({id:"sendy",provider_args:{installation_url:"#optin_sendy_installation_url"},errors:{installation_url:{name:"optin_sendy_installation_url",message:optin_vars.messages.sendy.enter_url,iconClass:"dashicons-warning-url"}}})})}(jQuery,document),Hustle.define("Optin.Wizard",function(e){"use strict";return Backbone.View.extend({el:"#wpoi-wizard",events:{"click .next-button button.wph-button-save":"save","click .next-button button.wph-button-next":"save","click .next-button button.wph-button-finish":"save","click .wph-toggletabs--title.can-open":"toggle_section","click .js-wph-optin-cancel":"cancel","click .js-wph-optin-back":"back"},toggle_section:function(t){var i=this.$(t.target),s=i.closest(".wph-toggletabs");e(".wph-toggletabs").not(s).removeClass("wph-toggletabs--open"),s.toggleClass("wph-toggletabs--closed wph-toggletabs--open")},validate:function(){var e=0;return this.$("#optin_new_name").val()||e++,this.$("#optin_new_provider_name").val()||this.$("#wpoi-test-mode-setup").is(":checked")||this.$("#wpoi-save-to-local").is(":checked")||e++,e},save:function(t){t.preventDefault(),Hustle.Events.trigger("Optin.save");var i=Optin.step.services.errors,s=this,n=this.$(t.target).closest("button"),o=n.data("nonce"),a=Optin.step.services.model.get("optin_id")||-1,l=a==-1;this.validate()>0||i>0||(n.attr("disabled",!0),n.hasClass("wph-button-next")||n.hasClass("wph-button-finish")?n.addClass("wph-button-next--loading"):n.addClass("wph-button-save--loading"),n.siblings().attr("disabled",!0),e.ajax({type:"POST",url:ajaxurl,data:{action:"inc_opt_save_new",id:a,_ajax_nonce:o,optin:Optin.step.services.model.toJSON(),design:Optin.step.design.model.toJSON(),settings:Optin.step.display.model.toJSON(),provider_args:Optin.step.services.provider_args.toJSON()},complete:function(){Optin.hasChanges=!1,n.attr("disabled",!1).removeClass("wph-button-next--loading").removeClass("wph-button-save--loading"),n.siblings().attr("disabled",!1),n.hasClass("wph-button-next")&&s.next(t),n.hasClass("wph-button-finish")&&s.finish_setup(t)},success:function(e){if(e.success){Optin.step.services.model.set("optin_id",e.data),Optin.hasChanges=!1;var t=window.location.pathname+window.location.search;l&&t.indexOf("&optin=")===-1&&(t+="&optin="+e.data,window.history.replaceState({},"",t))}}}))},next:function(t){var i=this.$(t.target),s=i.closest(".wph-toggletabs"),n=s.nextAll(".wph-toggletabs");if(n.length){var o=n.eq(0);return s.removeClass("wph-toggletabs--open").addClass("wph-toggletabs--closed"),o.addClass("wph-toggletabs--open"),void e("html, body").animate({scrollTop:o.offset().top},700)}},cancel:function(e){e.preventDefault(),window.onbeforeunload=null,window.location.replace("?page=inc_optin_listing")},finish_setup:function(e){e.preventDefault();var t=Optin.step.services.model.get("optin_id")||-1,i=t==-1;window.onbeforeunload=null;var s="?page=inc_optin_listing";s+=i?"&optin="+t:"&optin_updated="+t,window.location.replace(s)},back:function(t){t.preventDefault();var i=this.$(t.target),s=i.closest(".wph-toggletabs"),n=s.prevAll(".wph-toggletabs"),o=n.first();s.removeClass("wph-toggletabs--open"),o.addClass("wph-toggletabs--open"),e("html, body").animate({scrollTop:o.offset().top},700)}})}),Hustle.define("Optin.Email_Services_Tab",function(e){"use strict";return Hustle.View.extend(_.extend({},Hustle.get("Mixins.Model_Updater"),{template:Hustle.template("wpoi-wizard-services_template"),el:"#wpoi-wizard-services",events:{"click .next-button button":"validate","change #optin_new_provider_name":"provider_change","click .optin_refresh_provider_details":"refresh_provider_details"},fields:{name:"#optin_new_name",provider:"#optin_new_provider_name",api_key:"#optin_api_key",mail_list:"#optin_email_list",test_mode:"#wpoi-test-mode-setup",save_to_local:"#wpoi-save-to-local"},init:function(t){return this.render(),this.provider_args=t.provider_args,this.$details_placeholder=e("#optin_new_provider_account_details"),this.$options_placeholder=e("#optin_new_provider_account_options"),this.params=this.get_params(),"undefined"!=typeof this.params.code&&window.setTimeout(function(){e("#optin_new_provider_name").trigger("change")},750),_.each(Optin.Mixins.get_services_mixins(),function(e,t){e&&"function"==typeof e&&(this[t]=e(this))},this),this.listenTo(this.model,"change:test_mode",this.toggle_optin_provider_settings),this.listenTo(this.model,"change:optin_name",this.set_shortcode_id),this},render:function(){return this.$el.html(this.template(this.model.toJSON())),this.toggle_optin_provider_settings(),this},toggle_optin_provider_settings:function(){var t=this;this.$(".wph-label--notice").each(function(){var i=e(this);i.hasClass("wph-label--persist_notice")||(i.toggleClass("hidden",_.isFalse(t.model.get("test_mode"))),i.siblings().toggleClass("hidden",_.isTrue(t.model.get("test_mode"))))}),this.$("#optin_new_provider_name").prop("disabled",_.isTrue(this.model.get("test_mode")))},update_model:function(t){t&&t.preventDefault();e(".optwiz-container");Optin.step.model=Optin.step.model||new Optin.Model(optin_vars.current.data),Optin.step.model.set("optin_name",this.$(this.fields.name).val()),Optin.step.model.set("optin_provider",this.$(this.fields.provider).val()),this.$(this.fields.api_key)&&Optin.step.model.set("api_key",this.$(this.fields.api_key).val()),this.$(this.fields.mail_list).length&&Optin.step.model.set("optin_mail_list",this.$(this.fields.mail_list).val()),Optin.step.model.set("test_mode",this.$(this.fields.test_mode).is(":checked")?1:0),Optin.step.model.set("save_to_local",this.$(this.fields.save_to_local).is(":checked")?1:0),this.toggle_optin_provider_settings()},set_shortcode_id:function(){var e=_.isEmpty(Optin.step.model.get("optin_name"))?"":Optin.step.model.get("optin_name").toString().toLowerCase().trim().replace(/\s+/g,"-");Optin.step.display.model.set("shortcode_id",e)},validate:function(t){void 0!==t&&t.preventDefault(),Optin.Events.trigger("services:validate:before"),this.update_model(),Optin.step.services.errors=0;var i=Optin.step.model.validate_first_step(),s=this.$("#optin_new_provider_name").val();if(s&&this[s]&&"function"==typeof this[s].validate){var n=this[s].validate.call(this,i);i=_(i._wrapped.concat(n._wrapped))}if(!i.size()||this.$(this.fields.test_mode).is(":checked")&&!_.isEmpty(this.$(this.fields.name).val())||this.$(this.fields.save_to_local).is(":checked")&&!_.isEmpty(this.$(this.fields.name).val()))void 0!==t&&Optin.router.navigate("design",!0);else{var o=this;this.$el.find("span.dashicons-warning").remove(),i.each(function(t,i){var s=e('<span class="dashicons dashicons-warning"></span>'),n=o.$(o.fields[t.name]);n.length&&(s.attr("title",t.message),n.hasClass("wdev-styled")?n.closest(".select-container").addClass("wpoi-error"):n.addClass("wpoi-error"),n.closest(".select-container").length?n.closest(".select-container").before(s):n.after(s))})}Optin.Events.trigger("services:validate:after")},get_params:function(){var e=location.search,t="&";return _.chain(e.slice(1).split(t)).map(function(e){if(e)return e.split("=")}).compact().object().value()},provider_change:function(t){var i=this,s=e(t.currentTarget).val(),n=e("#wpoi-email-provider-details-container");return s?(n.show(),this.$details_placeholder.html(""),this.$options_placeholder.html(""),this.remove_prev_provider_args(),void e.ajax({url:ajaxurl,type:"get",async:!0,data:{action:"render_provider_account_options",provider_id:t.target.value,_ajax_nonce:e(t.target).data("nonce"),optin:i.model.get("optin_id")},success:function(s){if(s.success===!0)i.$details_placeholder.html(s.data),"constantcontact"==t.target.value&&"undefined"!=typeof i.params.code&&(e("#optin_api_key").val(i.params.code),e(".optin_refresh_provider_details").trigger("click")),i.delegateEvents(),Hustle.Events.trigger("view.rendered",i);else{var n="";s.data&&_.isArray(s.data)&&(n=s.data.join(", ")),i.$details_placeholder.html(n)}}})):void n.hide()},refresh_provider_details:function(t){var i=this,s=this.$(t.target),n=s.closest("form"),o=this.$(".wpoi-box"),a=n.serialize(),l=s.closest("#wpoi-get-lists").find("input"),r=this.$("#optin_new_provider_account_options");return _.isEmpty(l.val())?t.preventDefault():(this.remove_prev_provider_args(),r.html(this.$("#wpoi_loading_indicator").html()),a+="&action=refresh_provider_account_details","undefined"!=typeof i.model.attributes.optin_id&&(a+="&optin="+i.model.attributes.optin_id),o.find("input,select,button").attr("disabled",!0),Optin.step.services.provider_args.clear({silent:!0}),Optin.step.services.model.set("optin_mail_list","none"),void e.post(ajaxurl,a,function(e){o.find("input,select,button").attr("disabled",!1),e.success===!0?e.data.redirect_to?window.location.href=e.data.redirect_to:(e.data?r.html(e.data):r.html(optin_vars.messages.something_went_wrong),i.$("select").wpmuiSelect()):e.data?r.html(e.data):r.html(optin_vars.messages.something_went_wrong)}).fail(function(e){r.html(optin_vars.messages.something_went_wrong)}))},remove_prev_provider_args:function(){var t=e("#wpoi-mailchimp-prev-group-args");t.empty()}}))}),Hustle.define("Optin.Design_Tab",function(e){"use strict";var t=Hustle.View.extend({template:Hustle.template("wpoi-module-field"),tagName:"tr",options:{},controller:!1,events:{"change [name]":"updateOptions","click .wph-column-icon":"removeModule"},initialize:function(e){this.options=e.options,this.controller=e.controller,this.field_container=this.controller.$("tbody"),this.render()},render:function(){this.$el.html(this.template(this.options)).attr("data-index",this.options.index),this.$el.appendTo("#wpoi-module-fields");var e=this,t={items:"tr",containment:this.controller.$(".wph-table--module_fields table"),stop:function(t,i){e.reOrderFields()}};this.field_container.sortable(t).disableSelection()},reOrderFields:function(){var t=this,i=[];this.field_container.find("tr").each(function(s){var n=e(this),o=n.data("index"),a=t.controller.module_fields[o];a.index=s,i[s]=a,n.data("index",s)}),this.controller.module_fields=i,this.controller.model.set("module_fields",i)},updateOptions:function(t){var i=e(t.currentTarget),s=i.attr("name"),n=i.val(),o=Optin.step.services.model.get("optin_provider");return"required"===s&&(n=i.is(":checked")),this.options[s]=n,o&&optin_vars.providers[o]&&_.contains(["name","label"],s)?void Optin.Events.trigger("optin:update_module_field_"+o,this.options,this,this.controller.optin.toJSON().optin_id):void this._updateOptions()},_updateOptions:function(){this.controller.module_fields[this.options.index]=this.options,this.controller.model.set("module_fields",this.controller.module_fields)},removeModule:function(){var e=this,t=0;this.controller.module_fields=_.filter(this.controller.module_fields,function(i){if(i.name!=e.options.name)return i.index=t,t++,i}),this.controller.model.set("module_fields",this.controller.module_fields),this.remove()}});return Hustle.View.extend(_.extend({},Hustle.get("Mixins.Model_Updater"),{template:Hustle.template("wpoi-wizard-design_template"),message_editor:!1,success_editor:!1,structure_tpl:Hustle.template("wpoi-wizard-design_structure_template"),module_fields_tpl:Hustle.template("wpoi-wizard-design_module_fields_template"),shapes_tpl:Hustle.template("wpoi-wizard-design_shapes_template"),after_submit_tpl:Hustle.template("wpoi-wizard-design_after_submit_template"),color_pickers_tpl:Hustle.template("optin-color-pickers"),el:"#wpoi-wizard-design",preview:!1,preview_model:!1,defaults:{optin_input_icons:""},module_index:0,stylable_elements:{main_background:".wpoi-hustle .wpoi-optin",title_color:".wpoi-hustle h2.wpoi-title",link_color:".wpoi-hustle .wpoi-message p a",content_color:".wpoi-hustle .wpoi-message, .wpoi-hustle .wpoi-message p",link_hover_color:".wpoi-hustle .wpoi-message p a:hover",link_active_color:".wpoi-hustle .wpoi-message p a:active, .wpoi-hustle .wpoi-message p a:focus",form_background:".wpoi-hustle .wpoi-form",fields_background:".wpoi-hustle form .wpoi-element",fields_hover_background:".wpoi-hustle form .wpoi-element:hover",fields_active_background:".wpoi-hustle form .wpoi-element:active, .wpoi-hustle form .wpoi-element:focus",label_color:".wpoi-hustle form .wpoi-element label, .wpoi-hustle form .wpoi-element label span, .wpoi-hustle form .wpoi-element .wphi-font",button_background:".wpoi-hustle form button",button_label:".wpoi-hustle form button",fields_color:".wpoi-hustle form > .wpoi-element input",fields_hover_color:".wpoi-hustle form > .wpoi-element input:hover",fields_active_color:".wpoi-hustle form > .wpoi-element input:active, .wpoi-hustle form > .wpoi-element input:focus",error_color:".wpoi-hustle form .i-error, .wpoi-hustle form .i-error + span",button_hover_background:".wpoi-hustle form button:hover",button_active_background:".wpoi-hustle form button:active, .wpoi-hustle form button:focus",button_hover_label:".wpoi-hustle form button:hover",button_active_label:".wpoi-hustle form button:active, .wpoi-hustle form button:focus",checkmark_color:".wpoi-hustle .wpoi-success-message .wphi-font",success_color:".wpoi-hustle .wpoi-success-message .wpoi-content, .wpoi-hustle .wpoi-success-message .wpoi-content p",close_color:"a.inc-opt-close-btn, a.inc-opt-close-btn:visited",nsa_color:".wpoi-nsa > a, .wpoi-nsa > a.inc_opt_never_see_again",overlay_background:".wpoi-popup-overlay",close_hover_color:"a.inc-opt-close-btn:hover",nsa_hover_color:".wpoi-nsa > a:hover, .wpoi-nsa > a.inc_opt_never_see_again:hover",nsa_active_color:".wpoi-nsa > a:active, .wpoi-nsa > a.inc_opt_never_see_again:active, .wpoi-nsa > a:focus, .wpoi-nsa > a.inc_opt_never_see_again:focus",radio_background:'.wpoi-hustle form .wpoi-mcg-option input[type="radio"] + label:before',radio_checked_background:'.wpoi-hustle form .wpoi-mcg-option input[type="radio"]:checked + label:after',checkbox_background:'.wpoi-hustle form .wpoi-mcg-option input[type="checkbox"] + label:before',checkbox_checked_color:'.wpoi-hustle form .wpoi-mcg-option input[type="checkbox"]:checked + label:before',mcg_title_color:".wpoi-hustle form .wpoi-mcg-list-name, .wpoi-hustle .wpoi-submit-failure",mcg_label_color:'.wpoi-hustle form .wpoi-mcg-option input[type="checkbox"] + label, .wpoi-hustle form .wpoi-mcg-option input[type="radio"] + label',close_active_color:"a.inc-opt-close-btn:active, a.inc-opt-close-btn:focus"},events:{"click .wph-preview--eye":"open_preview","change #optin_color_palettes":"update_color_palette","submit form.wpoi-form-wrap":"cancel_dummy_optin_submit","change #optin-active-css":"toggleCustomCSS","click #optin_apply_custom_css":"apply_custom_css","click .wph-triggers--options label":"handle_triggers","mouseenter .wpoi-stylable-element":"highlight_stylable_element","mouseleave .wpoi-stylable-element":"highlight_stylable_element","click .wpoi-stylable-element":"insert_stylable_element","change #optin_fname":"update_optional_elements","change #optin_lname":"update_optional_elements","change #optin_customize_color_palette":"_toggleColorScheme",'change [name="on_success"]':"updateMeta",'change [name="on_success_time"]':"updateMeta",'change [name="on_success_unit"]':"updateMeta","change .wysiwyg-tab":"toggleSuccessMessageFields","click .add-new-module-field":"newModuleField","click .wph-cancel-add-field":"cancelAddField","click .wph-add-new-field":"addNewField",'keyup [data-name="label"]':"removeWarningIcons",'keyup [data-name="name"]':"removeWarningIcons"},stylables:{".wpoi-hustle .wpoi-optin ":"Opt-in Container",".wpoi-title ":"Title",".wpoi-message, .wpoi-message p ":"Content",".wpoi-form ":"Form Container",".wpoi-form .wpoi-subscribe-fname ":"First Name",".wpoi-form .wpoi-subscribe-lname ":"Last Name",".wpoi-form .wpoi-subscribe-email ":"Email",".wpoi-form .wpoi-subscribe-send ":"Form Button"},init:function(e){return this.optin=e.optin,this.listenTo(this.model,"change",this.render_structure),this.listenTo(this.model,"change:colors.customize",this.render_color_pickers),this.listenTo(this.model,"change:borders.fields_style",this.render_shapes),this.listenTo(this.model,"change:on_submit",this.render_on_submit),this.listenTo(this.model,"change:image_style",this.update_image_style),this.listenTo(this.model,"change:image_src",this.update_image_style),this.listenTo(this.model,"change:form_location",this.set_proper_image_location),this.listenTo(Hustle.Events,"Optin.save",this.sync_model_data),this.listenTo(Hustle.Events,"Optin.preview.changed.type",this.preview_type_changed),this.render()},render:function(){this.$el.html(this.template(_.extend({},{palettes:Palettes.toJSON()},{stylables:this.stylables},this.optin.toJSON(),this.model.toJSON()))),this.render_structure(),this.render_module_fields(),this.render_shapes(),this.render_on_submit(),this.create_editors(),this.update_styles(),this.update_borders_style(),this.render_color_pickers(),this.render_image_holder(),this.update_image_style(),this.apply_custom_css()},render_structure:function(){this.$("#wph-optin--structure").html(this.structure_tpl(this.model.toJSON()))},render_module_fields:function(){this.$("#wph-optin--module-fields").html(this.module_fields_tpl(this.model.toJSON())),this.module_fields=this.model.get("module_fields"),this.module_fields||(this.module_fields=optin_vars.module_fields),_.each(this.module_fields,function(e){e.index=this.module_index;new t({options:e,controller:this});this.module_index+=1},this)},handle_triggers:function(t){var i=e(t.target),s=i.closest("li"),n=s.siblings();n.removeClass("current"),s.addClass("current")},render_shapes:function(){var e=this.model.toJSON();e.wph_disabled="","joined"===this.model.get("borders.fields_style")&&(e.wph_disabled="disabled"),this.$("#wph-optin--shapes").html(this.shapes_tpl(e)),Hustle.Events.trigger("view.rendered",this.$("#wph-optin--shapes")),this.create_color_pickers()},render_on_submit:function(){"success_message"==this.model.get("on_submit")?this.$("label[for='wpoi-sm']").show():(this.$("label[for='wpoi-sm']").hide(),this.$("label[for='wpoi-om']").click())},update_image_style:function(){var e=this.model.get("image_src"),t=this.model.get("image_style"),i=this.$(".wph-media--holder .wph-media--preview");e.trim()&&i.length&&i.css("background-size",t)},create_color_pickers:function(){this.$(".optin_color_picker").not(".wp-color-picker").wpColorPicker({change:function(t,i){var s=e(this);s.val(i.color.toCSS()).trigger("change")}})},render_image_holder:function(){var e=Hustle.get("Media_Holder");this.media_holder=new e({model:this.model,attribute:"image_src"}),this.$(".wph-media--holder").html(this.media_holder.$el)},cancel_dummy_optin_submit:function(e){e.preventDefault()},update_color_palette:function(e){var t=Palettes.findWhere({_id:e.target.value}),i=(this.model.get("colors").toJSON(),Hustle.get("Models.M"));this.model.set("colors",new i(_.extend({},t.toJSON(),{palette:e.target.value}))),this.$("#optin_customize_color_palette").prop("checked",!1),this.render_color_pickers()},render_color_pickers:function(){var e=this.$("#optwiz-custom_color");_.isTrue(this.model.get("colors.customize"))?e.html(this.color_pickers_tpl(this.model.toJSON())).removeClass("hidden"):e.addClass("hidden"),this.create_color_pickers()},_fix_layout_3_sizes:function(){e(".wpoi-layout-three .wpoi-optin:not(.wpoi-small) .nocontent:not(.noimage)").each(function(){var t=e(this),i=t.find(".wpoi-aside-x").prev(".wpoi-element"),s=t.find(".wpoi-aside-x").prev(".wpoi-element").find(".wpoi-container.wpoi-col");s.css("height",i.height())}),e(".wpoi-layout-three .wpoi-optin:not(.wpoi-small) > .wpoi-container.noimage:not(.nocontent)").each(function(){var t=e(this),i=t.find(".wpoi-aside-x"),s=t.find(".wpoi-image").next(".wpoi-element"),n=i.prev(".wpoi-element"),o=t.find(".wpoi-content"),a=n.find(".wpoi-col"),l=t.find("form");l.height()>o.height()&&(a.css("height",i.height()+"px"),s.addClass("wpoi-align"),o.addClass("wpoi-align-element")),l.height()<o.height()&&(i.css("height",n.height()+"px"),i.addClass("wpoi-align"),l.addClass("wpoi-align-element"))}),e(".wpoi-layout-three .wpoi-optin:not(.wpoi-small) > .wpoi-container:not(.noimage):not(.nocontent)").each(function(){var t=e(this),i=t.find(".wpoi-aside-x"),s=i.prev(".wpoi-element"),n=t.find("form");n.height()<s.height()&&(i.css("height",s.height()),i.addClass("wpoi-align"),n.addClass("wpoi-align-element"))})},create_editors:function(){this._bind_to_message_editor(),this._create_css_editor()},highlight_stylable_element:function(t){
var i=e(t.target),s=e(i.data("stylable"));s.toggleClass("optin_hovered_stylable_element")},insert_stylable_element:function(t){t.preventDefault();var i=e(t.target),s=i.data("stylable")+"{}";this.css_editor.navigateFileEnd(),this.css_editor.insert(s),this.css_editor.navigateLeft(1),this.css_editor.focus()},apply_proper_preview_classes:function(){e(".wpoi-hustle").each(function(){e(this).width()<=405?e(this).find(".wpoi-optin").addClass("wpoi-small"):e(this).find(".wpoi-optin").removeClass("wpoi-small"),e(this).width()<=585&&e(this).width()>405?e(this).find(".wpoi-optin").addClass("wpoi-medium"):e(this).find(".wpoi-optin").removeClass("wpoi-medium")}),e(".wpoi-layout-three .wpoi-optin:not(.wpoi-small) .wpoi-form").each(function(){e(this).height()>168?(e(this).addClass("wpoi-align"),e(this).next("form").addClass("wpoi-align-element")):(e(this).removeClass("wpoi-align"),e(this).next("form").removeClass("wpoi-align-element"))}),e(".wpoi-mcg-select").each(function(){e(this).parent(".wpoi-provider-args > .wpoi-container > .wpoi-element:nth-child(2) > .wpoi-container > .wpoi-element").css({padding:"0",background:"transparent"})}),e(".wpoi-layout-three .wpoi-optin:not(.wpoi-small) .nocontent:not(.noimage)").each(function(){var t=e(this),i=t.find(".wpoi-aside-x").prev(".wpoi-element"),s=t.find(".wpoi-aside-x").prev(".wpoi-element").find(".wpoi-container.wpoi-col");s.css("height",i.height())}),e(".wpoi-layout-three .wpoi-optin:not(.wpoi-small) > .wpoi-container.noimage:not(.nocontent)").each(function(){var t=e(this),i=t.find(".wpoi-aside-x"),s=t.find(".wpoi-image").next(".wpoi-element"),n=i.prev(".wpoi-element"),o=t.find(".wpoi-content"),a=n.find(".wpoi-col"),l=t.find("form");l.height()>o.height()&&(a.css("height",i.height()+"px"),s.addClass("wpoi-align"),o.addClass("wpoi-align-element")),l.height()<o.height()&&(i.css("height",n.height()+"px"),i.addClass("wpoi-align"),l.addClass("wpoi-align-element"))}),e(".wpoi-layout-three .wpoi-optin:not(.wpoi-small) > .wpoi-container:not(.noimage):not(.nocontent)").each(function(){var t=e(this),i=t.find(".wpoi-aside-x"),s=i.prev(".wpoi-element"),n=t.find("form");n.height()<s.height()&&(i.css("height",s.height()),i.addClass("wpoi-align"),n.addClass("wpoi-align-element"))}),e(".wpoi-layout-three .wpoi-optin:not(.wpoi-small)").each(function(){for(var t=e(this),i=t.find("form > .wpoi-element:not(.wpoi-provider-args)"),s=0;s<i.length;s+=2)i.slice(s,s+2).wrapAll('<div class="wpoi-element" style="background-color: transparent;"><div class="wpoi-container"></div></div>')}),e(".wpoi-layout-four .wpoi-optin:not(.wpoi-small)").each(function(){for(var t=e(this),i=t.find("form > .wpoi-element:not(.wpoi-provider-args)"),s=0;s<i.length;s+=2)i.slice(s,s+2).wrapAll('<div class="wpoi-element" style="background-color: transparent;"><div class="wpoi-container"></div></div>')}),e(".wpoi-layout-four .wpoi-optin:not(.wpoi-small) > .wpoi-container.noimage:not(.nocontent)").each(function(){var t=e(this),i=t.find(".wpoi-aside-xl"),s=t.find(".wpoi-aside-xl > .wpoi-container"),n=i.find(".wpoi-form"),o=i.find("form"),a=i.next(".wpoi-element"),l=a.find(".wpoi-content");l.height()>o.height()&&(s.css("height",i.height()+"px"),n.addClass("wpoi-align"),o.addClass("wpoi-align-element")),l.height()<o.height()&&(a.css("height",s.height()+"px"),a.addClass("wpoi-align"),l.addClass("wpoi-align-element"))}),e(".wpoi-layout-four .wpoi-optin:not(.wpoi-small) > .wpoi-container:not(.noimage):not(.nocontent)").each(function(){var t=e(this),i=t.find(".wpoi-aside-xl"),s=t.find(".wpoi-aside-xl > .wpoi-container"),n=t.find(".wpoi-image"),o=i.find(".wpoi-form"),a=i.find("form"),l=i.next(".wpoi-element"),r=t.find(".wpoi-content");r.height()>s.height()&&(s.css("height",i.height()+"px"),o.css("height",s.height()-n.height()),o.addClass("wpoi-align"),a.addClass("wpoi-align-element")),r.height()<s.height()&&(l.css("height",i.height()+"px"),l.addClass("wpoi-align"),r.addClass("wpoi-align-element"))})},_bind_to_message_editor:function(){var e=this,t=setInterval(function(){"object"==typeof tinymce&&(clearInterval(t),tinymce.on("AddEditor",function(t){var i=function(){t&&"optin_message"===t.editor.getParam("id")&&e.optin.set("optin_message",this.getContent()),t&&"success_message"===t.editor.getParam("id")&&e.model.set("success_message",this.getContent()),e.apply_proper_preview_classes()};t&&"optin_message"===t.editor.getParam("id")&&(e.message_editor=t.editor),t&&"success_message"===t.editor.getParam("id")&&(e.success_editor=t.editor),t.editor.on("loadContent",function(e){this.dom.setStyle("tinymce","maxWidth","100%")}),Optin.Events.off("navigate",e.refresh_editor,e),Optin.Events.on("navigate",e.refresh_editor,e),e.on("rendered",e.refresh_editor,e),t.editor.on("change",i),t.editor.on("AddUndo",i),t.editor.on("keyup",i),e.apply_proper_preview_classes()}))},50)},refresh_editor:function(t,i){"design"===i&&_.isObject(this.message_editor)&&(this.message_editor.remove(),tinymce.init(this.message_editor.settings),e(this.message_editor.settings.selector+"_ifr").height(240),this.success_editor.remove(),tinymce.init(this.success_editor.settings),e(this.success_editor.settings.selector+"_ifr").height(240))},_create_css_editor:function(){this.css_editor=ace.edit("optin_custom_css"),this.css_editor.getSession().setMode("ace/mode/css"),this.css_editor.setTheme("ace/theme/solarized_light"),this.css_editor.getSession().setUseWrapMode(!0),this.css_editor.getSession().setUseWorker(!1),this.css_editor.setShowPrintMargin(!1),this.css_editor.renderer.setShowGutter(!0),this.css_editor.setHighlightActiveLine(!0),this.css_editor.on("blur",e.proxy(this.update_custom_css,this))},_create_color_pickers:function(){var e=this;this.$(".optin_color_picker").wpColorPicker({change:function(t,i){var s="update_"+this.id.replace("optin_","");"function"==typeof e[s]?e[s](t,i):console.warn("Method ",s," not found")}}),this.$(".ui-draggable-handle").click(function(e){e.preventDefault()})},update_custom_css:function(){this.model.set("css",this.css_editor.getValue())},_toggleColorScheme:function(){var t=e("#optin_color_palettes"),i=e("#optin_customize_color_palette");t.prop("disabled",i.is(":checked"))},toggleCustomCSS:function(t){var i=e(t.currentTarget),s=i.is(":checked"),n=this.$("#wph-css-holder");n[s?"removeClass":"addClass"]("hidden"),i.closest("label.wph-label--border").toggleClass("toggle-off")},apply_custom_css:function(t){t&&(t.preventDefault(),e(t.target).prop("disabled",!0)),this._toggleColorScheme(),this.update_custom_css();var i=e("#optin-custom-styles").length?e("#optin-custom-styles"):e('<style id="optin-custom-styles">').appendTo("body"),s=this.css_editor.getValue();e.ajax({type:"POST",url:ajaxurl,dataType:"json",data:{action:"inc_opt_prepare_custom_css",css:s,_ajax_nonce:e("#optin_custom_css").data("nonce"),optin_id:optin_vars.current.data.optin_id},success:function(s){s&&s.success&&i.html(s.data),t&&e(t.target).prop("disabled",!1)},error:function(){t&&e(t.target).prop("disabled",!1)}})},get_layout_colors:function(){return _.isTrue(this.model.get("colors.customize"))?this.model.toJSON().colors:Palettes.findWhere({_id:this.model.get("colors.palette")}).toJSON()},update_styles:function(){var t=this.get_layout_colors(),i="",s=e("#optin-preview-styles").length?e("#optin-preview-styles"):e('<style id="optin-preview-styles">').appendTo("body");_.each(this.stylable_elements,function(e,s){var n=s.indexOf("background")!==-1?"background":"color",o=t[s];i+=e+"{ "+n+": "+o+";} "}),s.html(i)},update_borders_style:function(){var t=this.model.toJSON().borders,i=this.stylable_elements,s="",n=e("#optin-preview-styles-borders").length?e("#optin-preview-styles-borders"):e('<style id="optin-preview-styles-borders">').appendTo("body");s+=i.main_background+"{border-radius:"+t.corners_radius+"px;}","joined"===this.model.get("borders").get("fields_style")?(s+=i.fields_background+"{border-radius: 0px;}",s+=i.button_background+"{border-radius: 0px;}"):(s+=i.fields_background+"{border-radius:"+t.fields_corners_radius+"px;}",s+=i.button_background+"{border-radius:"+t.button_corners_radius+"px;}"),s+=i.main_background+"{box-shadow: 0 0 "+t.dropshadow_value+"px "+t.shadow_color+"}",n.html(s)},update_optional_elements:function(e){var t=this.model.get("elements");e.target.checked?(t.push(e.target.value),this.model.set("elements",t,{silent:!0})):this.model.set("elements",_.without(t,e.target.name),{silent:!0})},_show_args:function(){return"mailchimp"===Optin.step.services.model.get("optin_provider")&&!Optin.step.services.provider_args.isEmpty()&&"hidden"!==Optin.step.services.provider_args.get("group").form_field},set_proper_image_location:function(e){0!==e.get("form_location")&&e.set("image_location","left")},_set_preview_model:function(){var e=this.optin.toJSON(),t=function(){return!("mailchimp"!==e.optin_provider||!Optin.step.services.provider_args||!Optin.step.services.provider_args.get("group")||"hidden"===Optin.step.services.provider_args.get("group").form_field)},i=Optin.step.display.model.toJSON();return this.preview_model?void this.preview_model.set(_.extend({image_style:"",type:"popup"},this.model.toJSON(),this.model.get("borders").toJSON(),this.optin.toJSON(),{types:{after_content:i.after_content,popup:i.popup,slide_in:i.slide_in}},{has_args:t()})):void(this.preview_model=new Backbone.Model(_.extend({image_style:"",type:"popup"},this.model.toJSON(),this.model.get("borders").toJSON(),this.optin.toJSON(),{types:{after_content:i.after_content,popup:i.popup,slide_in:i.slide_in}},{has_args:t()})))},open_preview:function(e){if(Optin.Events.trigger("design:preview:render:start"),this.sync_model_data(),this._set_preview_model(),this.preview)this.preview.render(),this.preview.show();else{var t=Hustle.get("Optin.Preview");this.preview=new t({model:this.preview_model}),this.preview.show()}this._fix_layout_3_sizes(),this.update_styles(),this.update_borders_style(),this.apply_proper_preview_classes(),this.apply_custom_css()},preview_type_changed:function(){this._fix_layout_3_sizes(),this.update_styles(),this.update_borders_style(),this.apply_proper_preview_classes(),this.apply_custom_css()},sync_model_data:function(){var t=this.model.get("optin_title");t||(t=e("#optin_title").val()),this.optin.set("optin_title",t),"object"==typeof tinymce&&(this.message_editor||(this.message_editor=tinymce.get("optin_message")),this.optin.set("optin_message",this.message_editor.getContent()),this.success_editor||(this.success_editor=tinymce.get("success_message")),this.model.set("success_message",this.success_editor.getContent()))},updateMeta:function(t){var i=e(t.currentTarget),s=i.attr("name");this.model.set(s,i.val())},toggleSuccessMessageFields:function(t){var i=e(t.currentTarget),s="success_message"===i.val(),n=e("#wpoi-success-message-fields");n[s?"removeClass":"addClass"]("hidden")},newModuleField:function(t){var i=e(t.currentTarget);this.$("#wpoi-module-field-maker").removeClass("hidden");i.attr("disabled","disabled")},cancelAddField:function(){var t=this.$("#wpoi-module-field-maker").addClass("hidden");e(".dashicons-warning",t).remove(),e('[type="text"]',t).val(""),this.$(".add-new-module-field").attr("disabled",!1)},addNewField:function(){var t=this.$("[data-name]","#wpoi-module-field-maker").not(":disabled"),i={},s=0;if(_.each(t,function(t){t=e(t);var n=t.data("name"),o=t.val();if(_.contains(["label","name"],n)&&""===o.trim()){s++;var a=e('<span class="dashicons dashicons-warning"></span>');t.after(a),"label"===n&&a.attr("title",optin_vars.messages.module_fields.no_label),"name"===n&&a.attr("title",optin_vars.messages.module_fields.no_name)}"name"===n&&this.$('td.wph-column-name input[name="name"]').each(function(i){if(e(this).val()===o){s++;var n=e('<span class="dashicons dashicons-warning"></span>'),a=optin_vars.messages.module_fields.custom_field_already_exists.replace("{name}",o);t.after(n),n.attr("title",a)}}),"checkbox"===t.attr("type")?i[n]=t.is(":checked"):i[n]=t.val()},this),!(s>0)){this.removeWarningIcons();var n=Optin.step.services.model.get("optin_provider");return n&&optin_vars.providers[n]?(Optin.Events.trigger("optin:add_module_field_"+n,i,this,this.optin.toJSON().optin_id),!1):void this._add_module_field(i)}},_add_module_field:function(e){e.index=this.module_index++;new t({options:e,controller:this});this.module_fields.push(e),this.model.set("module_fields",this.module_fields),this.$(".wph-cancel-add-field").trigger("click")},removeWarningIcons:function(){this.$(".dashicons-warning","#wpoi-module-field-maker").remove()}}))}),function(e){"use strict";Optin.View.Display_Triggers=Backbone.View.extend(e.extend(!0,{},Optin.View.Template_Mixin,{template:Optin.template("wpoi-wizard-settings-triggers-template"),events:{"click .tabs-header label":"change_tab"},initialize:function(e){this.el=e.el,this.type=e.type,this.listenTo(this.model,"change:"+this.type+".trigger_on_adblock",this.hide_adblock_options_on_toggle),this.render()},render:function(){return this.$el.html(this.template(this.get_data())),this.hide_adblock_options_on_toggle(),this},get_data:function(){var e={};return e.type=this.type,e.shortcode_id=this.model.get("shortcode_id"),_.extend({},e,this.model.get(this.type).toJSON())},change_tab:function(e){e.preventDefault();var t=this.$(e.target),i=t.parent("li"),s=this.$(t.attr("href")),n=t.find("input[type='radio']");this.$(".tabs-header li").removeClass("current"),this.$(".tabs-content").removeClass("current"),i.addClass("current"),s.addClass("current"),n.prop("checked",!0),this.model.set(this.type+".appear_after",n.val())},hide_adblock_options_on_toggle:function(){_.isTrue(this.model.get(this.type+".trigger_on_adblock"))?this.$(".wpoi-popup-trigger-on-adblock-option").show():this.$(".wpoi-popup-trigger-on-adblock-option").hide()}}))}(jQuery),Hustle.define("Optin.Display_Tab",function(e){"use strict";return Hustle.View.extend(_.extend({},Hustle.get("Mixins.Model_Updater"),{template:Optin.template("wpoi-wizard-settings_template"),widget_message_tpl:Optin.template("wpoi-wizard-settings_widget_template"),el:"#wpoi-wizard-settings",events:{"click .next-button a.previous":"go_to_design","click .can-open.display-settings-icon span.open i.dev-icon":"toggle_boxes","change #wpoi-after-content-state-toggle":"optin_type_toggle","change #wpoi-popup-state-toggle":"optin_type_toggle","change #wpoi-slide-in-state-toggle":"optin_type_toggle"},init:function(){return this.listenTo(this.model,"change:after_content.animate",this.toggle_after_content_animation_select),this.listenTo(this.model,"change:popup.enabled",this.render),this.listenTo(this.model,"change:slide_in.enabled",this.render),this.listenTo(this.model,"change:after_content.enabled",this.render),this.listenTo(this.model,"change:slide_in.position",this.update_slide_in_position_label),this.listenTo(this.model,"change:shortcode_id",_.bind(this.render_widget_message,this)),this.render()},move_selects_under_selected_radio:function(e,t,i){var s=this.model.get(e),n="."+e.replace(".","_")+"_block",o=n+"_select_wrap",a=this.$(n).eq(1),l=this.$(o);a.length&&l.length&&(_.isTrue(s)?a.insertAfter(l):a.insertBefore(l))},render_widget_message:function(){var e=this.widget_message_tpl(this.model.toJSON());this.$("#wpoi-wizard-settings-widget-message").html(e)},render:function(){var t=Hustle.get("Settings.Conditions_View");this.popup_conditions_view=new t({model:this.model.get("popup.conditions"),type:"popup"}),this.slide_in_conditions_view=new t({model:this.model.get("slide_in.conditions"),type:"slide_in"}),this.after_content_conditions_view=new t({model:this.model.get("after_content.conditions"),type:"after_content"}),this.model.set("slide_in.position_label",optin_vars.messages.positions[this.model.get("slide_in.position")],{silent:!0}),this.$el.html(this.template(e.extend(!0,{},this.model.toJSON(),{popup:{condition_labels:this.popup_conditions_view.get_all_conditions_labels()},after_content:{condition_labels:this.after_content_conditions_view.get_all_conditions_labels()},slide_in:{condition_labels:this.slide_in_conditions_view.get_all_conditions_labels()}}))),this.render_widget_message(),this.popup_conditions_view.delegateEvents(),this.popup_conditions_view.on("toggle_condition",this.render_condition_labels),this.popup_conditions_view.on("change:update_view_label",this.render_condition_labels),this.$("#wph-optin--popup_conditions .wph-conditions").html(this.popup_conditions_view.$el),this.slide_in_conditions_view.delegateEvents(),this.slide_in_conditions_view.on("toggle_condition",this.render_condition_labels),this.slide_in_conditions_view.on("change:update_view_label",this.render_condition_labels),this.$("#wph-optin--slide_in_conditions .wph-conditions").html(this.slide_in_conditions_view.$el),this.after_content_conditions_view.delegateEvents(),this.after_content_conditions_view.on("toggle_condition",this.render_condition_labels),this.after_content_conditions_view.on("change:update_view_label",this.render_condition_labels),this.$("#wph-optin--after_content_conditions .wph-conditions").html(this.after_content_conditions_view.$el);new Optin.View.Display_Triggers({model:this.model,el:"#triggers-section-popup",type:"popup"}),new Optin.View.Display_Triggers({model:this.model,el:"#triggers-section-slide_in",type:"slide_in"});this.$el.find(".can-open.display-settings-icon span.open i.dev-icon").trigger("click")},optin_type_toggle:function(t){var i=e(t.target),s=i.closest(".wpoi-toggle-block"),n=s.find("p").first(),o=i.closest(".wpoi-listing-wrap").find("section");i.is(":checked")?(n.fadeOut(),s.removeClass("inactive")):(n.fadeIn(),s.addClass("inactive")),o.is(".closed")&&i.is(":checked")&&i.closest(".wpoi-toggle-mask").find("span.open i.dev-icon").trigger("click")},toggle_boxes:function(t){var i=e(t.target),s="dev-icon-caret_up",n="dev-icon-caret_down",o=i.hasClass(s)?s:n,a=o==s?n:s,l=i.closest(".wpoi-listing-wrap").find("section");i.switchClass(o,a),l.toggleClass("closed",o==n),l.toggle(a==n)},go_to_design:function(e){e.preventDefault(),Optin.router.navigate("design",!0)},toggle_after_content_animation_select:function(){_.isTrue(this.model.get("after_content.animate"))?this.$("#optin-afterc-animation-block").show(function(){e(this).removeClass("hidden")}):this.$("#optin-afterc-animation-block").hide(function(){e(this).addClass("hidden")})},update_slide_in_position_label:function(e){this.$("#wpoi-slide_in-position-label").text(optin_vars.messages.positions[this.model.get("slide_in.position")])},render_condition_labels:function(t){var i={after_content:e("#wph-after-content-condition-labels"),popup:e("#wph-popup-condition-labels"),slide_in:e("#wph-slide-in-condition-labels")};i[t.type]&&i[t.type].html(t.get_all_conditions_labels())}}))});var Inc_Opt_Router=Backbone.Router.extend({routes:{"":"services",services:"services",design:"design","display(/:optin_type)":"display"},route:function(e,t,i){var s=this;i||(i=this[t]);var n=function(){if(Optin.step.model||(Optin.step.model=new Optin.Model(optin_vars.current.data)),!parseInt(optin_vars.is_limited)){var e=Hustle.get("Optin.Email_Services_Tab");if(!Optin.step.services){var t=Hustle.get("Models.M");Optin.step.services=new e({model:Optin.step.model,provider_args:new t(optin_vars.current.provider_args)})}var n=Hustle.get("Optin.Design_Tab");Optin.step.design||(Optin.step.design=new n({model:new Optin.Models.Design_Model(optin_vars.current.design),optin:Optin.step.model}));var o=Hustle.get("Optin.Display_Tab");if(Optin.step.display||(Optin.step.display=new o({model:new Optin.Models.Settings_Model(optin_vars.current.settings)})),!Optin.step.wizard){var a=Hustle.get("Optin.Wizard");Optin.step.wizard=new a}}i.apply(s,arguments)};return Backbone.Router.prototype.route.call(this,e,t,n)},execute:function(e,t,i){var s=_.keys(this.routes).indexOf(i)-1;if(s==Optin.step.current)return Optin.router.navigate(_.keys(this.routes)[Optin.step.current+1],!1),!1;switch(Optin.step.current){case 0:var n=Optin.step.model.validate_first_step();if(n.size())return Optin.step.services.validate(),Optin.router.navigate(_.keys(this.routes)[Optin.step.current+1],!1),!1}Optin.Events.trigger("navigate",t,i),e&&e.apply(this,t)},services:function(){Optin.step.activate_step(0)},design:function(){Optin.step.activate_step(1)},display:function(e){Optin.step.activate_step(2),e=e||"",""!==e&&jQuery("#wpoi-listing-wrap-"+e).length&&jQuery("#wpoi-listing-wrap-"+e).find("i.dev-icon:not(.search-icon)").trigger("click")}});adminpage=adminpage.replace("hustle-pro","hustle"),"hustle_page_inc_optin"==adminpage&&(Optin.router=new Inc_Opt_Router,Backbone.history.start());
//# sourceMappingURL=maps/admin.min.js.map
